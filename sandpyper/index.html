
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://npucino.github.io/sandpyper/sandpyper/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.2.3">
    
    
      
        <title>sandpyper module - Sandpyper</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sandpyper.sandpyper" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Sandpyper" class="md-header__button md-logo" aria-label="Sandpyper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sandpyper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              sandpyper module
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com//npucino//sandpyper/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Sandpyper" class="md-nav__button md-logo" aria-label="Sandpyper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Sandpyper
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com//npucino//sandpyper/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com//npucino//sandpyper//issues" class="md-nav__link">
        Report Issues
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" data-md-state="indeterminate" type="checkbox" id="__nav_7" checked>
      
      <label class="md-nav__link" for="__nav_7">
        Methods
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extraction%20and%20lod/" class="md-nav__link">
        Elevation analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ML%20and%20SA/" class="md-nav__link">
        Data cleaning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hotspot_methods/" class="md-nav__link">
        Hotspot analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bcds_method/" class="md-nav__link">
        BCDs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../volumetrics_method/" class="md-nav__link">
        Volumetrics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      <label class="md-nav__link" for="__nav_8">
        API Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          sandpyper module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        sandpyper module
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sandpyper.sandpyper" class="md-nav__link">
    sandpyper.sandpyper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics" class="md-nav__link">
    ProfileDynamics
  </a>
  
    <nav class="md-nav" aria-label="ProfileDynamics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.BCD_compute_location" class="md-nav__link">
    BCD_compute_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.BCD_compute_transects" class="md-nav__link">
    BCD_compute_transects()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.compute_multitemporal" class="md-nav__link">
    compute_multitemporal()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.compute_volumetrics" class="md-nav__link">
    compute_volumetrics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.discretise" class="md-nav__link">
    discretise()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.infer_weights" class="md-nav__link">
    infer_weights()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.LISA_site_level" class="md-nav__link">
    LISA_site_level()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_alongshore_change" class="md-nav__link">
    plot_alongshore_change()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_location_ebcds" class="md-nav__link">
    plot_location_ebcds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_lod_normality_check" class="md-nav__link">
    plot_lod_normality_check()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_mec_evolution" class="md-nav__link">
    plot_mec_evolution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_single_loc" class="md-nav__link">
    plot_single_loc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_trans_matrices" class="md-nav__link">
    plot_trans_matrices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_transect_mecs" class="md-nav__link">
    plot_transect_mecs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_transects" class="md-nav__link">
    plot_transects()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet" class="md-nav__link">
    ProfileSet
  </a>
  
    <nav class="md-nav" aria-label="ProfileSet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.cleanit" class="md-nav__link">
    cleanit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.extract_profiles" class="md-nav__link">
    extract_profiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.kmeans_sa" class="md-nav__link">
    kmeans_sa()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../common/" class="md-nav__link">
        common module
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" data-md-state="indeterminate" type="checkbox" id="__nav_9" checked>
      
      <label class="md-nav__link" for="__nav_9">
        Notebooks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Notebooks" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/1%20-%20Introduction%20and%20data%20preparation/" class="md-nav__link">
        Introduction and data preparation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/2%20-%20Profiles%20extraction%2C%20unsupervised%20sand%20labelling%20and%20cleaning/" class="md-nav__link">
        Profile extraction, LoD and data cleaning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/3%20-%20Profile%20dynamics/" class="md-nav__link">
        Multiscale sediment dynamics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/Space%20analysis%20-%20teaser/" class="md-nav__link">
        Space analysis   teaser
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sandpyper.sandpyper" class="md-nav__link">
    sandpyper.sandpyper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics" class="md-nav__link">
    ProfileDynamics
  </a>
  
    <nav class="md-nav" aria-label="ProfileDynamics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.BCD_compute_location" class="md-nav__link">
    BCD_compute_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.BCD_compute_transects" class="md-nav__link">
    BCD_compute_transects()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.compute_multitemporal" class="md-nav__link">
    compute_multitemporal()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.compute_volumetrics" class="md-nav__link">
    compute_volumetrics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.discretise" class="md-nav__link">
    discretise()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.infer_weights" class="md-nav__link">
    infer_weights()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.LISA_site_level" class="md-nav__link">
    LISA_site_level()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_alongshore_change" class="md-nav__link">
    plot_alongshore_change()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_location_ebcds" class="md-nav__link">
    plot_location_ebcds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_lod_normality_check" class="md-nav__link">
    plot_lod_normality_check()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_mec_evolution" class="md-nav__link">
    plot_mec_evolution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_single_loc" class="md-nav__link">
    plot_single_loc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_trans_matrices" class="md-nav__link">
    plot_trans_matrices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_transect_mecs" class="md-nav__link">
    plot_transect_mecs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.plot_transects" class="md-nav__link">
    plot_transects()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileDynamics.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet" class="md-nav__link">
    ProfileSet
  </a>
  
    <nav class="md-nav" aria-label="ProfileSet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.cleanit" class="md-nav__link">
    cleanit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.extract_profiles" class="md-nav__link">
    extract_profiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.kmeans_sa" class="md-nav__link">
    kmeans_sa()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandpyper.sandpyper.ProfileSet.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              



                
                  <a href="https://github.com/npucino/sandpyper/edit/master/docs/sandpyper.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>sandpyper module</h1>
                
                <div class="doc doc-object doc-module">

<a id="sandpyper.sandpyper"></a>
    <div class="doc doc-contents first">

      <p>Main Sandpyper module defining the ProfileSet and ProfileDynamics classes with their analytical and plotting methods.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics">
        <code>ProfileDynamics</code>



<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>The ProfileDynamics object manages all volumetric and behavioural dynamics computation and plotting.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ProfileSet</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.__init__" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Instantiates a ProfileDynamics object with a discretisation scheme for future behavioural dynamics computation.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ProfileSet</code></td>
        <td><code>object</code></td>
        <td><p>ProfileSet object that stores all the monitoring information.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bins</code></td>
        <td><code>int</code></td>
        <td><p>Number of bins that both erosional and depositional classes will be partitioned into.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>method</code></td>
        <td><code>str</code></td>
        <td><p>Name of the algorithm used to discretise the data. Choose between 'EqualInterval', 'FisherJenks', 'HeadTailBreaks', 'JenksCaspall', 'KClassifiers', 'Quantiles', 'Percentiles'. Head to Pysal GitHub page https://github.com/pysal/mapclassify for more info on classifiers.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td><code>list</code></td>
        <td><p>List of labels to assign to the bins, in order to be able to name them and keep the analysis meaningful. Name labels from low to high magnitudes, like ["small","medium","high"] in case of bins=3.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>ProfileDynamics object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ProfileSet</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Instantiates a ProfileDynamics object with a discretisation scheme for future behavioural dynamics computation.</span>

<span class="sd">    Args:</span>
<span class="sd">        ProfileSet (object): ProfileSet object that stores all the monitoring information.</span>
<span class="sd">        bins (int): Number of bins that both erosional and depositional classes will be partitioned into.</span>
<span class="sd">        method (str): Name of the algorithm used to discretise the data. Choose between &#39;EqualInterval&#39;, &#39;FisherJenks&#39;, &#39;HeadTailBreaks&#39;, &#39;JenksCaspall&#39;, &#39;KClassifiers&#39;, &#39;Quantiles&#39;, &#39;Percentiles&#39;. Head to Pysal GitHub page https://github.com/pysal/mapclassify for more info on classifiers.</span>
<span class="sd">        labels (list): List of labels to assign to the bins, in order to be able to name them and keep the analysis meaningful. Name labels from low to high magnitudes, like [&quot;small&quot;,&quot;medium&quot;,&quot;high&quot;] in case of bins=3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: ProfileDynamics object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classifiers</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> not a valid method name. Supported method in this docstring.&quot;</span><span class="p">)</span>

    <span class="c1"># Check that bins is valid list, integer or None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The list provided cannot have zero or only one break point!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;Percentiles&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">max</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When using percentiles as break points, the provided list must be in the range [0, 100].&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data will be partitioned using user-provided percentiles.&quot;</span><span class="p">)</span>
                    <span class="n">bins_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data will be partitioned using user-provided bins.&quot;</span><span class="p">)</span>
                <span class="n">bins_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bins</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of bins to use cannot be zero, one or negative!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data will be partitioned into </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2"> discrete classes.&quot;</span><span class="p">)</span>
            <span class="n">bins_size</span><span class="o">=</span><span class="n">bins</span>

    <span class="k">elif</span> <span class="n">bins</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Automatic discretisation will be performed. This method is time consuming with large datasets.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The bins parameter is not understood. Must be either a list, integer or None.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">labels</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">!=</span><span class="n">bins_size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of labels doesn&#39;t match the provided bins. They must be the same. Alternatively, set labels=None to not use labels.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Labels provided.&quot;</span><span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">=</span><span class="n">bins</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">=</span><span class="n">method</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bins_size</span><span class="o">=</span><span class="n">bins_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">=</span><span class="n">ProfileSet</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.BCD_compute_location">
<code class="highlight language-python"><span class="n">BCD_compute_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_field</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">store_neg</span><span class="p">,</span> <span class="n">filterit</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.BCD_compute_location" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>It computes first order stochastic transition matrices, Empirical and Residual Beachface Cluster Dynamics (e-BCDS, r-BCDs) indices at the location scale.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>unique_field</code></td>
        <td><code>dataframe</code></td>
        <td><p>Field storing spatial IDs, which identify a point in spatial dimension but not in temporal dimension. This naturally fits the geometry column so use 'geometry' if in doubt.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mode</code></td>
        <td><code>str, float</code></td>
        <td><p>If a float is provided, this indicates the percentage of time that the points need to be significant clusters across the periods in order to be retained. The no cluster state is renamed "nnn". Insert "drop" to remove all cluster to no-cluster transitions, or 'all' to keep them all and rename cluster-to-no clsuter state 'nnn'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>store_neg</code></td>
        <td><code>bool</code></td>
        <td><p>If True (default), use the subtraction for diminishing trends. Default True.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filterit</code></td>
        <td><code>str</code></td>
        <td><p>if None (default), all points will be used. If 'lod' or 'hotspot', only points above the LoDs or statistically significant clusters (hot/coldspots) will be retained. If 'both', both lod and hotspot filters will be applied.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>(tuple)</code></td>
      <td><p>Tuple containing:
    location_ebcds (pd.DataFrame) Dataframe storing e-BCDs indices and trends (new ProfileDynamics attribute)
    transitions_matrices (dict) (new ProfileDynamics attribute)
    sign(str) can be '-' or '+' for plotting purposes
    markov_details (dict) Dictionary storing number of points (n), number of timesteps (t) and number of transitions (n_transitions) for each location (new ProfileDynamics attribute)
    location_ss (pd.DataFrame) Dataframe storing steady-state vectors and r-BCDs indices (new ProfileDynamics attribute)</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BCD_compute_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">unique_field</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">store_neg</span><span class="p">,</span> <span class="n">filterit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;It computes first order stochastic transition matrices, Empirical and Residual Beachface Cluster Dynamics (e-BCDS, r-BCDs) indices at the location scale.</span>

<span class="sd">    Args:</span>
<span class="sd">        unique_field (dataframe): Field storing spatial IDs, which identify a point in spatial dimension but not in temporal dimension. This naturally fits the geometry column so use &#39;geometry&#39; if in doubt.</span>
<span class="sd">        mode (str, float): If a float is provided, this indicates the percentage of time that the points need to be significant clusters across the periods in order to be retained. The no cluster state is renamed &quot;nnn&quot;. Insert &quot;drop&quot; to remove all cluster to no-cluster transitions, or &#39;all&#39; to keep them all and rename cluster-to-no clsuter state &#39;nnn&#39;.</span>
<span class="sd">        store_neg (bool): If True (default), use the subtraction for diminishing trends. Default True.</span>
<span class="sd">        filterit (str): if None (default), all points will be used. If &#39;lod&#39; or &#39;hotspot&#39;, only points above the LoDs or statistically significant clusters (hot/coldspots) will be retained. If &#39;both&#39;, both lod and hotspot filters will be applied.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple): Tuple containing:</span>
<span class="sd">            location_ebcds (pd.DataFrame) Dataframe storing e-BCDs indices and trends (new ProfileDynamics attribute)</span>
<span class="sd">            transitions_matrices (dict) (new ProfileDynamics attribute)</span>
<span class="sd">            sign(str) can be &#39;-&#39; or &#39;+&#39; for plotting purposes</span>
<span class="sd">            markov_details (dict) Dictionary storing number of points (n), number of timesteps (t) and number of transitions (n_transitions) for each location (new ProfileDynamics attribute)</span>
<span class="sd">            location_ss (pd.DataFrame) Dataframe storing steady-state vectors and r-BCDs indices (new ProfileDynamics attribute)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">steady_state_victoria</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">markov_indexes_victoria</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">transitions_matrices</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">filterit</span> <span class="o">==</span> <span class="s1">&#39;lod&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lod_used</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No LoD was used during the discretise method was run.</span><span class="se">\</span>
<span class="s1">            Please re-run ProfileDynamics.discretise with an LoD value or dataframe to use LoD filter here.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_to_use</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;lod_valid==&#39;yes&#39;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LoD filter in use. Only points beyond LoDs will be retained.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">filterit</span> <span class="o">==</span> <span class="s1">&#39;hotspot&#39;</span><span class="p">:</span>
        <span class="n">data_to_use</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;lisa_q in [1,3]&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hotspot filter in use. Only statistically significant clusters will be retained.&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">filterit</span> <span class="o">==</span> <span class="s1">&#39;both&#39;</span><span class="p">:</span>
        <span class="n">data_to_use</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;lod_valid == &#39;yes&#39; and lisa_q in [1,3]&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hotspot and LoD filters in use. Only statistically significant clusters beyond LoDs will be retained.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_to_use</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span>


    <span class="n">markov_details</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">data_to_use</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>

        <span class="k">if</span> <span class="s2">&quot;nnn&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags_order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tags_order</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;nnn&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_to_use</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">unique_field</span><span class="p">],</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span><span class="p">):</span>
            <span class="n">data_to_use</span><span class="p">[</span><span class="s1">&#39;spatial_id&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data_to_use</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">unique_field</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">unique_field</span><span class="o">=</span><span class="s1">&#39;spatial_id&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">dataset_piv</span> <span class="o">=</span> <span class="n">data_to_use</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">loc</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
            <span class="n">values</span><span class="o">=</span><span class="s2">&quot;markov_tag&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">unique_field</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;dt&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">dataset_piv</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;nnn&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;drop&quot;</span><span class="p">:</span>
            <span class="n">dataset_piv</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>

            <span class="n">dts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_piv</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

            <span class="n">dataset_piv</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">dataset_piv</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;nnn&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
                <span class="s2">&quot; Specify the mode (&#39;drop&#39;, &#39;all&#39;, or a float number (0.5,1.0,0.95)&quot;</span>
            <span class="p">)</span>



        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dataset_piv</span><span class="p">)</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">Markov</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

        <span class="n">markov_details</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">loc</span><span class="p">:{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="n">dataset_piv</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="n">dataset_piv</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                            <span class="s1">&#39;n_transitions&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">transitions</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())}})</span>

        <span class="n">steady_state</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">steady_state</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">loc</span><span class="p">])</span>
        <span class="n">steady_state_victoria</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">steady_state</span><span class="p">,</span> <span class="n">steady_state_victoria</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">markov_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span>

        <span class="c1"># if any column is missing from label_order, then add both row and column</span>
        <span class="c1"># and populate with zeroes</span>
        <span class="k">if</span> <span class="n">markov_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">all</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># plus nnn</span>
            <span class="c1"># which one is missing?</span>
            <span class="n">missing_states</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">state</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags_order</span> <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">markov_df</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="p">(</span>
                <span class="n">miss</span>
            <span class="p">)</span> <span class="ow">in</span> <span class="n">missing_states</span><span class="p">:</span>  <span class="c1"># for all missing states, add columns with zeroes</span>
                <span class="n">markov_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">miss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="c1"># # at the end of the (squared) dataframe</span>
                <span class="n">last_idx</span> <span class="o">=</span> <span class="n">markov_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">markov_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">markov_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

            <span class="c1"># get a list of str of the missing states</span>
            <span class="n">to_rename</span> <span class="o">=</span> <span class="n">markov_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_states</span><span class="p">)</span> <span class="p">:]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">to_rename</span><span class="p">,</span> <span class="n">missing_states</span><span class="p">):</span>
                <span class="n">markov_df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">j</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">markov_ordered</span> <span class="o">=</span> <span class="n">markov_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tags_order</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags_order</span><span class="p">]</span>

        <span class="c1"># When no transition occurred, replace NaN with a 0.</span>
        <span class="n">markov_ordered</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">idx_matrix</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>

        <span class="n">dd</span> <span class="o">=</span> <span class="n">markov_ordered</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">idx_matrix</span><span class="p">,</span> <span class="p">:</span><span class="n">idx_matrix</span><span class="p">]</span>
        <span class="n">dd</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="n">dd</span><span class="o">.</span><span class="n">columns</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">ee</span> <span class="o">=</span> <span class="n">markov_ordered</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx_matrix</span><span class="o">+</span><span class="mi">1</span><span class="p">:,</span> <span class="n">idx_matrix</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">ee</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ee</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">de</span> <span class="o">=</span> <span class="n">markov_ordered</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">idx_matrix</span><span class="p">,</span> <span class="n">idx_matrix</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">ed</span> <span class="o">=</span> <span class="n">markov_ordered</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx_matrix</span><span class="o">+</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="n">idx_matrix</span><span class="p">]</span>
        <span class="n">ed</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ed</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ed</span> <span class="o">=</span> <span class="n">ed</span><span class="p">[</span><span class="n">ed</span><span class="o">.</span><span class="n">columns</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">list_markovs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ee</span><span class="p">,</span> <span class="n">ed</span><span class="p">,</span> <span class="n">dd</span><span class="p">,</span> <span class="n">de</span><span class="p">]</span>
        <span class="n">transitions_matrices</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">loc</span><span class="p">:</span><span class="n">list_markovs</span><span class="p">})</span>
        <span class="n">dict_markovs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ee&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="p">,</span> <span class="s2">&quot;ed&quot;</span><span class="p">:</span> <span class="n">ed</span><span class="p">,</span> <span class="s2">&quot;dd&quot;</span><span class="p">:</span> <span class="n">dd</span><span class="p">,</span> <span class="s2">&quot;de&quot;</span><span class="p">:</span> <span class="n">de</span><span class="p">}</span>


        <span class="c1"># create index dataframe</span>

        <span class="k">for</span> <span class="n">arr_markov</span> <span class="ow">in</span> <span class="n">dict_markovs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="n">idx</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">sign</span> <span class="o">=</span> <span class="n">get_coastal_Markov</span><span class="p">(</span>
                <span class="n">dict_markovs</span><span class="p">[</span><span class="n">arr_markov</span><span class="p">],</span> <span class="n">weights_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weights_dict</span><span class="p">,</span> <span class="n">store_neg</span><span class="o">=</span><span class="n">store_neg</span>
            <span class="p">)</span>

            <span class="n">idx_coastal_markov_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="n">loc</span><span class="p">,</span>
                <span class="s2">&quot;sub_matrix&quot;</span><span class="p">:</span> <span class="n">arr_markov</span><span class="p">,</span>
                <span class="s2">&quot;coastal_markov_idx&quot;</span><span class="p">:</span> <span class="n">idx</span><span class="p">,</span>
                <span class="s2">&quot;trend&quot;</span><span class="p">:</span> <span class="n">trend</span><span class="p">,</span>
                <span class="s2">&quot;sign&quot;</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">idx_coastal_markov_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">idx_coastal_markov_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">markov_indexes_victoria</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">idx_coastal_markov_df</span><span class="p">,</span> <span class="n">markov_indexes_victoria</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>


        <span class="c1"># here I translate the submatrix codes into the names and store them in a column</span>

        <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Erosional&quot;</span><span class="p">,</span> <span class="s2">&quot;Recovery&quot;</span><span class="p">,</span> <span class="s2">&quot;Depositional&quot;</span><span class="p">,</span><span class="s2">&quot;Vulnerability&quot;</span><span class="p">]</span>
        <span class="n">translation</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;ee&quot;</span><span class="p">,</span><span class="s2">&quot;ed&quot;</span><span class="p">,</span><span class="s2">&quot;dd&quot;</span><span class="p">,</span><span class="s2">&quot;de&quot;</span><span class="p">],</span><span class="n">titles</span><span class="p">))</span>
        <span class="n">markov_indexes_victoria</span><span class="p">[</span><span class="s2">&quot;states_labels&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">markov_indexes_victoria</span><span class="p">[</span><span class="s2">&quot;sub_matrix&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">translation</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">location_ebcds</span><span class="o">=</span><span class="n">markov_indexes_victoria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transitions_matrices</span><span class="o">=</span><span class="n">transitions_matrices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markov_details</span><span class="o">=</span><span class="n">markov_details</span>


        <span class="n">ss_victoria_ordered</span><span class="o">=</span><span class="n">steady_state_victoria</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tags_order</span><span class="p">,:]</span>
        <span class="n">ss_victoria_ordered</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;nnn&quot;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Create erosion and deposition sub-matrix</span>
        <span class="n">erosion</span><span class="o">=</span><span class="n">ss_victoria_ordered</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx_matrix</span><span class="p">:,:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">erosion</span><span class="p">[</span><span class="s2">&quot;total_erosion&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">erosion</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">erosion</span><span class="o">=</span><span class="n">erosion</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;index&quot;</span><span class="p">:</span><span class="s2">&quot;location&quot;</span><span class="p">},</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">deposition</span><span class="o">=</span><span class="n">ss_victoria_ordered</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="n">idx_matrix</span><span class="p">,:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">deposition</span><span class="p">[</span><span class="s2">&quot;total_deposition&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">deposition</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">deposition</span><span class="o">=</span><span class="n">deposition</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;index&quot;</span><span class="p">:</span><span class="s2">&quot;location&quot;</span><span class="p">},</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">merged</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">deposition</span><span class="p">,</span><span class="n">erosion</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;r_bcds&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">merged</span><span class="o">.</span><span class="n">total_deposition</span><span class="o">-</span> <span class="n">merged</span><span class="o">.</span><span class="n">total_erosion</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
        <span class="n">merged</span><span class="o">=</span><span class="n">merged</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">location_ss</span><span class="o">=</span><span class="n">merged</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.BCD_compute_transects">
<code class="highlight language-python"><span class="n">BCD_compute_transects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc_specs</span><span class="p">,</span> <span class="n">reliable_action</span><span class="p">,</span> <span class="n">dirNameTrans</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.BCD_compute_transects" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>It computes Residual Beachface Cluster Dynamics (r-BCDs) indices at the transect scale.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>loc_specs</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary specifying minimum required valid points per transect and minimum number of timesteps required to consider a transect reliable. Must be provided in this neste dictionary form: loc_specs={'mar':{'thresh':6,'min_points':6}, 'leo': {'thresh':4, 'min_points':5}}</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>reliable_action</code></td>
        <td><code>str</code></td>
        <td><p>If 'drop', only retains transects that are reliable. Otherwise, keep all the transects. The transect reliability depends on the thresh and min_points parameters provided with loc_specs dictionary.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dirNameTrans</code></td>
        <td><code>str</code></td>
        <td><p>Path of the directory containing the transect files (.gpkg, .shp).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>transects_rbcd (gpd.GeoDataFrame)</code></td>
      <td><p>GeoDataframe storing r-BCDs indices (new ProfileDynamics attribute).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BCD_compute_transects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc_specs</span><span class="p">,</span> <span class="n">reliable_action</span><span class="p">,</span> <span class="n">dirNameTrans</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;It computes Residual Beachface Cluster Dynamics (r-BCDs) indices at the transect scale.</span>

<span class="sd">    Args:</span>
<span class="sd">        loc_specs (dict): Dictionary specifying minimum required valid points per transect and minimum number of timesteps required to consider a transect reliable. Must be provided in this neste dictionary form: loc_specs={&#39;mar&#39;:{&#39;thresh&#39;:6,&#39;min_points&#39;:6}, &#39;leo&#39;: {&#39;thresh&#39;:4, &#39;min_points&#39;:5}}</span>
<span class="sd">        reliable_action (str): If &#39;drop&#39;, only retains transects that are reliable. Otherwise, keep all the transects. The transect reliability depends on the thresh and min_points parameters provided with loc_specs dictionary.</span>
<span class="sd">        dirNameTrans (str): Path of the directory containing the transect files (.gpkg, .shp).</span>

<span class="sd">    Returns:</span>
<span class="sd">        transects_rbcd (gpd.GeoDataFrame): GeoDataframe storing r-BCDs indices (new ProfileDynamics attribute).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transects_rbcd</span><span class="o">=</span><span class="n">get_rbcd_transect</span><span class="p">(</span><span class="n">df_labelled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span><span class="p">,</span>
              <span class="n">loc_specs</span><span class="o">=</span><span class="n">loc_specs</span><span class="p">,</span>
              <span class="n">dirNameTrans</span><span class="o">=</span><span class="n">dirNameTrans</span><span class="p">,</span>
              <span class="n">reliable_action</span><span class="o">=</span><span class="n">reliable_action</span><span class="p">,</span>
              <span class="n">labels_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tags_order</span><span class="p">,</span>
              <span class="n">loc_codes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">loc_codes</span><span class="p">,</span>
              <span class="n">crs_dict_string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">crs_dict_string</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.compute_multitemporal">
<code class="highlight language-python"><span class="n">compute_multitemporal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc_full</span><span class="p">,</span> <span class="n">lod_mode</span><span class="o">=</span><span class="s1">&#39;inherited&#39;</span><span class="p">,</span> <span class="n">geometry_column</span><span class="o">=</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="n">date_field</span><span class="o">=</span><span class="s1">&#39;raw_date&#39;</span><span class="p">,</span> <span class="n">filter_class</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.compute_multitemporal" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Compute points elevation change timeseries. Additionally, when LoD profiles had been provided during the ProfileSet object instantiation, compute LoD points as well. Additionally, creates time periods details table (dh_details).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>loc_full</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary where keys are location codes ('mar') and values are full lengtht location names ('Marengo').</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lod_mode</code></td>
        <td><code>str</code></td>
        <td><p>Values in meters (crs must be projected) used as distance band for neigthours definition in distance weight matrix computation.</p></td>
        <td><code>&#39;inherited&#39;</code></td>
      </tr>
      <tr>
        <td><code>geometry_column</code></td>
        <td><code>str</code></td>
        <td><p>Name of the column storing the geometry information.</p></td>
        <td><code>&#39;coordinates&#39;</code></td>
      </tr>
      <tr>
        <td><code>date_field</code></td>
        <td><code>int</code></td>
        <td><p>Name of the column storing the survey date information.</p></td>
        <td><code>&#39;raw_date&#39;</code></td>
      </tr>
      <tr>
        <td><code>filter_class</code></td>
        <td><code>list, str</code></td>
        <td><p>Name or list of names of classes used to filter data. For instance, setting this as 'sand' would compute elevation changes of sand only if 'sand' is a class previously computed.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dh_df (pd.DataFrame)</code></td>
      <td><p>Dataframe storing elevation change timeseries. Stored in the ProfileDynamics.dh_df attribute.
dh_details (pd.DataFrame): Dataframe storing information about time periods. Stored in the ProfileDynamics.dh_details attribute.
lod_dh (pd.DataFrame): Dataframe storing elevation change timeseries of points along LoD transects. Stored in the ProfileDynamics.lod_dh attribute.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_multitemporal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc_full</span><span class="p">,</span> <span class="n">lod_mode</span><span class="o">=</span><span class="s1">&#39;inherited&#39;</span><span class="p">,</span> <span class="n">geometry_column</span><span class="o">=</span><span class="s2">&quot;coordinates&quot;</span><span class="p">,</span> <span class="n">date_field</span><span class="o">=</span><span class="s1">&#39;raw_date&#39;</span><span class="p">,</span> <span class="n">filter_class</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute points elevation change timeseries. Additionally, when LoD profiles had been provided during the ProfileSet object instantiation, compute LoD points as well. Additionally, creates time periods details table (dh_details).</span>

<span class="sd">    Args:</span>
<span class="sd">        loc_full (dict): Dictionary where keys are location codes (&#39;mar&#39;) and values are full lengtht location names (&#39;Marengo&#39;).</span>
<span class="sd">        lod_mode (str): Values in meters (crs must be projected) used as distance band for neigthours definition in distance weight matrix computation.</span>
<span class="sd">        geometry_column (str): Name of the column storing the geometry information.</span>
<span class="sd">        date_field (int): Name of the column storing the survey date information.</span>
<span class="sd">        filter_class (list, str):  Name or list of names of classes used to filter data. For instance, setting this as &#39;sand&#39; would compute elevation changes of sand only if &#39;sand&#39; is a class previously computed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dh_df (pd.DataFrame): Dataframe storing elevation change timeseries. Stored in the ProfileDynamics.dh_df attribute.</span>
<span class="sd">        dh_details (pd.DataFrame): Dataframe storing information about time periods. Stored in the ProfileDynamics.dh_details attribute.</span>
<span class="sd">        lod_dh (pd.DataFrame): Dataframe storing elevation change timeseries of points along LoD transects. Stored in the ProfileDynamics.lod_dh attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span> <span class="o">=</span> <span class="n">compute_multitemporal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">profiles</span><span class="p">,</span>
        <span class="n">geometry_column</span><span class="o">=</span><span class="n">geometry_column</span><span class="p">,</span>
        <span class="n">date_field</span><span class="o">=</span><span class="n">date_field</span><span class="p">,</span>
        <span class="n">filter_class</span><span class="o">=</span><span class="n">filter_class</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dh_details</span> <span class="o">=</span> <span class="n">create_details_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="p">,</span> <span class="n">loc_full</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">land_limits</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;location&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">lod_mode</span><span class="o">==</span><span class="s1">&#39;inherited&#39;</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">lod</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">lod_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="n">lod_df</span><span class="p">[</span><span class="s1">&#39;lod&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lod_mode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_df</span><span class="o">=</span><span class="n">lod_df</span><span class="p">[[</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;lod&#39;</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_dh</span><span class="o">=</span><span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_created</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">lod</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing LoD dh data.&quot;</span><span class="p">)</span>
            <span class="n">lod_dh</span><span class="o">=</span><span class="n">compute_multitemporal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">lod</span><span class="p">,</span>
                <span class="n">geometry_column</span><span class="o">=</span><span class="n">geometry_column</span><span class="p">,</span>
                <span class="n">date_field</span><span class="o">=</span><span class="n">date_field</span><span class="p">,</span>
                <span class="n">filter_class</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_df</span><span class="o">=</span><span class="n">get_lod_table</span><span class="p">(</span><span class="n">lod_dh</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_dh</span><span class="o">=</span><span class="n">lod_dh</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_created</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">lod</span><span class="o">==</span><span class="kc">None</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_df</span><span class="o">=</span><span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_dh</span><span class="o">=</span><span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lod_created</span><span class="o">=</span><span class="s1">&#39;no&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;lod_mode attribute of the ProfileSet object not found. Has ProfileSet.extract_profiles been run?&quot;</span><span class="p">)</span>


    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lod_mode</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
        <span class="n">lod_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">lod_df</span><span class="p">[</span><span class="s1">&#39;lod&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lod_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_df</span><span class="o">=</span><span class="n">lod_df</span><span class="p">[[</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;lod&#39;</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_dh</span><span class="o">=</span><span class="kc">None</span>

    <span class="k">elif</span> <span class="n">lod_mode</span><span class="o">==</span><span class="kc">None</span> <span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_df</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_dh</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;lod_mode must be &#39;inherited&#39;, None or a numeric value.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.compute_volumetrics">
<code class="highlight language-python"><span class="n">compute_volumetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lod</span><span class="p">,</span> <span class="n">outliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma_n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.compute_volumetrics" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generate volumetric and altimetric change statistics both at the transect and location levels.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>lod</code></td>
        <td><code>pd.DataFrame, float, bool</code></td>
        <td><p>If a DataFRame is provided, it must be have a column named location with location codes and another called lod with lod values. If a float is provided, uses this value across all the serveys. If False is provided, then don't use LoD filters.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>outliers</code></td>
        <td><code>bool</code></td>
        <td><p>When True, use the specified number of standard deviations (sigma_n) to exclude outliers. If False, retain all the points.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>sigma_n</code></td>
        <td><code>int</code></td>
        <td><p>Number of standard deviation to use to exclude outliers (default=3).</p></td>
        <td><code>3</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ProfileDynamics attributes</code></td>
      <td><p>Two new attributes named location_volumetrics (pd.DataFrame) and transects_volumetrics (pd.DataFrame), which provide change information at the location and single transect scales respectively.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_volumetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lod</span><span class="p">,</span> <span class="n">outliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma_n</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate volumetric and altimetric change statistics both at the transect and location levels.</span>

<span class="sd">    Args:</span>
<span class="sd">        lod (pd.DataFrame, float, bool): If a DataFRame is provided, it must be have a column named location with location codes and another called lod with lod values. If a float is provided, uses this value across all the serveys. If False is provided, then don&#39;t use LoD filters.</span>
<span class="sd">        outliers (bool): When True, use the specified number of standard deviations (sigma_n) to exclude outliers. If False, retain all the points.</span>
<span class="sd">        sigma_n (int): Number of standard deviation to use to exclude outliers (default=3).</span>

<span class="sd">    Returns:</span>
<span class="sd">        ProfileDynamics attributes: Two new attributes named location_volumetrics (pd.DataFrame) and transects_volumetrics (pd.DataFrame), which provide change information at the location and single transect scales respectively.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="p">[</span><span class="s2">&quot;date_pre_dt&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pre</span><span class="p">),</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">pre</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">date_pre</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="p">[</span><span class="s2">&quot;date_post_dt&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">post</span><span class="p">),</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">date_post</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lod</span> <span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using LoDs.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_used</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lod</span> <span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using LoDs.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_used</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No LoD is used.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_used</span><span class="o">=</span><span class="s1">&#39;no&#39;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">location_volumetrics</span> <span class="o">=</span> <span class="n">get_state_vol_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="p">,</span> <span class="n">lod</span><span class="o">=</span><span class="n">lod</span><span class="p">,</span>
                                          <span class="n">full_specs_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_details</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">sampling_step</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">transects_volumetrics</span> <span class="o">=</span> <span class="n">get_transects_vol_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="p">,</span> <span class="n">lod</span><span class="o">=</span><span class="n">lod</span><span class="p">,</span>
                                    <span class="n">transect_spacing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">transects_spacing</span><span class="p">,</span>
                                    <span class="n">dx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">sampling_step</span><span class="p">,</span>
                                    <span class="n">outliers</span><span class="o">=</span><span class="n">outliers</span><span class="p">,</span><span class="n">sigma_n</span><span class="o">=</span><span class="n">sigma_n</span><span class="p">,</span>
                                    <span class="n">full_specs_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_details</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.discretise">
<code class="highlight language-python"><span class="n">discretise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">absolute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;dh&#39;</span><span class="p">,</span> <span class="n">appendix</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_deposition&#39;</span><span class="p">,</span> <span class="s1">&#39;_erosion&#39;</span><span class="p">),</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.discretise" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Fit the discretiser (specified when the ProfileDynamics object got instantiated) to the column of interest (default is 'dh').</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>lod</code></td>
        <td><code>int, float, pd.DataFrame</code></td>
        <td><p>Limit of Detections to use. Can be a single value for all surveys, an LoD dataframe or None if no LoD filtering is to be used.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>absolute</code></td>
        <td><code>bool</code></td>
        <td><p>whether to discretise the absolute values of the data or not. If True (default), the bins will be derived from absolute values, then, classes will be assigned to both negative and positive numbers accordingly.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>field</code></td>
        <td><code>str</code></td>
        <td><p>Name of the column with data to discretise. Data must be numeric.</p></td>
        <td><code>&#39;dh&#39;</code></td>
      </tr>
      <tr>
        <td><code>appendix</code></td>
        <td><code>tuple</code></td>
        <td><p>String to append at the end of each label when absolute is True. Defaults = ("_deposition","_erosion").</p></td>
        <td><code>(&#39;_deposition&#39;, &#39;_erosion&#39;)</code></td>
      </tr>
      <tr>
        <td><code>print_summary</code></td>
        <td><code>bool</code></td>
        <td><p>If True, prints out the bins specifications and the sum of absolute deviations around class medians as a goodness-metric.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>df_labelled (pd.DataFrame)</code></td>
      <td><p>Dataframe stored in the ProfileDynamics.df_labelled attribute, storing 'markov_tag' column, which holds the class of magnitude of change which will be used in discrete Markov models to compute BCDs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">discretise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">absolute</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;dh&quot;</span><span class="p">,</span> <span class="n">appendix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_deposition&quot;</span><span class="p">,</span><span class="s2">&quot;_erosion&quot;</span><span class="p">),</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fit the discretiser (specified when the ProfileDynamics object got instantiated) to the column of interest (default is &#39;dh&#39;).</span>

<span class="sd">    Args:</span>
<span class="sd">        lod (int, float, pd.DataFrame): Limit of Detections to use. Can be a single value for all surveys, an LoD dataframe or None if no LoD filtering is to be used.</span>
<span class="sd">        absolute (bool): whether to discretise the absolute values of the data or not. If True (default), the bins will be derived from absolute values, then, classes will be assigned to both negative and positive numbers accordingly.</span>
<span class="sd">        field (str): Name of the column with data to discretise. Data must be numeric.</span>
<span class="sd">        appendix (tuple): String to append at the end of each label when absolute is True. Defaults = (&quot;_deposition&quot;,&quot;_erosion&quot;).</span>
<span class="sd">        print_summary (bool): If True, prints out the bins specifications and the sum of absolute deviations around class medians as a goodness-metric.</span>

<span class="sd">    Returns:</span>
<span class="sd">        df_labelled (pd.DataFrame): Dataframe stored in the ProfileDynamics.df_labelled attribute, storing &#39;markov_tag&#39; column, which holds the class of magnitude of change which will be used in discrete Markov models to compute BCDs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hotspots</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">lod</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="p">):</span>  <span class="c1"># if a numeric, use this value across all surveys</span>

        <span class="n">full_data_lod</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">full_data_lod</span><span class="p">[</span><span class="s2">&quot;lod&quot;</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">lod</span><span class="p">)</span>
        <span class="n">full_data_lod</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">_abs&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">abs</span><span class="p">)</span>
        <span class="n">full_data_lod</span><span class="p">[</span><span class="s2">&quot;lod_valid&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">_abs&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">full_data_lod</span><span class="o">.</span><span class="n">lod</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_used</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lod</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">full_data_lod</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lod_df</span><span class="p">[[</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;lod&#39;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">full_data_lod</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">_abs&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">abs</span><span class="p">)</span>
        <span class="n">full_data_lod</span><span class="p">[</span><span class="s2">&quot;lod_valid&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">_abs&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">full_data_lod</span><span class="o">.</span><span class="n">lod</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_used</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">full_data_lod</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">full_data_lod</span><span class="p">[</span><span class="s2">&quot;lod&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lod_not_used&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">full_data_lod</span><span class="p">[</span><span class="s1">&#39;lod_valid&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lod_not_used&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">full_data_lod</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">_abs&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">abs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod_used</span><span class="o">=</span><span class="s1">&#39;no&#39;</span>

    <span class="k">if</span> <span class="n">absolute</span><span class="p">:</span>
        <span class="n">data_ero</span><span class="o">=</span><span class="n">full_data_lod</span><span class="p">[</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">field</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">data_depo</span><span class="o">=</span><span class="n">full_data_lod</span><span class="p">[</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">data</span><span class="o">=</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">_abs&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">full_data_lod</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">field</span><span class="p">]</span>

    <span class="n">bins_discretiser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dict_classifiers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">](</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">print_summary</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">bins_discretiser</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fit of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="si">}</span><span class="s2"> bins: </span><span class="si">{</span><span class="n">bins_discretiser</span><span class="o">.</span><span class="n">adcm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">bins_depo</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bins_discretiser</span><span class="o">.</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">bins_ero</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">bins_discretiser</span><span class="o">.</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">bins_ero_JC</span> <span class="o">=</span> <span class="n">UserDefined</span><span class="p">(</span><span class="n">data_ero</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">field</span><span class="p">],</span> <span class="n">bins_ero</span><span class="p">)</span>
    <span class="n">bins_depo_JC</span> <span class="o">=</span> <span class="n">UserDefined</span><span class="p">(</span><span class="n">data_depo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">field</span><span class="p">],</span> <span class="n">bins_depo</span><span class="p">)</span>

    <span class="n">class_erosion</span><span class="o">=</span><span class="n">bins_ero_JC</span><span class="o">.</span><span class="n">yb</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">class_deposition</span><span class="o">=</span><span class="n">bins_depo_JC</span><span class="o">.</span><span class="n">yb</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;bin_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bins_size</span><span class="p">)]</span>

    <span class="c1"># create dictionaries where keys are the bin number assigned by discretiser and value is the label</span>
    <span class="n">depo_class_names</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,[</span><span class="n">appendix</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))]</span>
    <span class="n">ero_class_names</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,[</span><span class="n">appendix</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))]</span>

    <span class="c1"># a general list of tags</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span><span class="n">appendix</span><span class="p">))]</span>
    <span class="n">reverse_tags</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tags_order</span><span class="o">=</span><span class="p">[</span><span class="n">reverse_tags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">reverse_tags</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>

    <span class="n">states_depo</span><span class="o">=</span><span class="p">{</span><span class="n">yb</span><span class="p">:</span><span class="n">class_name</span> <span class="k">for</span> <span class="n">yb</span><span class="p">,</span><span class="n">class_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">depo_class_names</span><span class="p">)}</span>
    <span class="n">states_ero</span><span class="o">=</span><span class="p">{</span><span class="n">yb</span><span class="o">*-</span><span class="mi">1</span><span class="p">:</span><span class="n">class_name</span> <span class="k">for</span> <span class="n">yb</span><span class="p">,</span><span class="n">class_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ero_class_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=-</span><span class="nb">len</span><span class="p">(</span><span class="n">ero_class_names</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)}</span>

    <span class="n">data_ero</span><span class="p">[</span><span class="s2">&quot;markov_tag&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">states_ero</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">class_erosion</span><span class="p">]</span>
    <span class="n">data_depo</span><span class="p">[</span><span class="s2">&quot;markov_tag&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">states_depo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">class_deposition</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_ero</span><span class="p">,</span><span class="n">data_depo</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.infer_weights">
<code class="highlight language-python"><span class="n">infer_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markov_tag_field</span><span class="o">=</span><span class="s1">&#39;markov_tag&#39;</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.infer_weights" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Compute weights from dataset with markov labels to use for e-BCDs computations. The medians of each magnitude class will be used as weight.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>markov_tag_field</code></td>
        <td><code>str</code></td>
        <td><p>Name of the column where markov tags are stored.</p></td>
        <td><code>&#39;markov_tag&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>weights_dict (dict)</code></td>
      <td><p>Dictionary storing magnitude class (markov_tags) weights, stored in the ProfileDynamics.weights_dict attribute.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">infer_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">markov_tag_field</span><span class="o">=</span><span class="s2">&quot;markov_tag&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute weights from dataset with markov labels to use for e-BCDs computations. The medians of each magnitude class will be used as weight.</span>

<span class="sd">    Args:</span>
<span class="sd">        markov_tag_field (str): Name of the column where markov tags are stored.</span>

<span class="sd">    Returns:</span>
<span class="sd">        weights_dict (dict): Dictionary storing magnitude class (markov_tags) weights, stored in the ProfileDynamics.weights_dict attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">joined_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span><span class="p">[</span><span class="s2">&quot;magnitude_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">joined_re</span><span class="p">,</span><span class="n">tag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">markov_tag_field</span><span class="p">]]</span>

    <span class="c1"># create a dictionary with all the medians of the magnitude classes</span>
    <span class="n">class_abs_medians</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;magnitude_class&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dh</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="mi">2</span><span class="p">)))</span>

    <span class="c1"># create a dictionary with all the weights in each tag</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weights_dict</span><span class="o">=</span><span class="p">{</span><span class="n">tag</span><span class="p">:</span><span class="n">class_abs_medians</span><span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">joined_re</span><span class="p">,</span><span class="n">tag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.LISA_site_level">
<code class="highlight language-python"><span class="n">LISA_site_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">distance_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">k_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">geometry_column</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.LISA_site_level" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Performs Hot-Spot analysis using Local Moran's I as Location Indicator of Spatial Association (LISA) with False Discovery Rate (fdr) correction for all the surveys.
    Please refer to PySAL package documentation for more info.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mode</code></td>
        <td><code>str</code></td>
        <td><p>If 'distance'(Default), compute spatial weight matrix using a distance-band kernel, specified in distance_value parameter.
                            If 'knn', spatial weight matrix uses a specified (k_value parameter) of k number closest points to compute weights.
                            if 'idw', Inverse Distance Weigthing is used with the specified decay power (decay parameter) to compute weight.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>distance_value</code></td>
        <td><code>int</code></td>
        <td><p>values in meters (crs must be projected) used as distance band for neigthours definition in distance weight matrix computation.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>decay</code></td>
        <td><code>int</code></td>
        <td><p>power of decay to use with IDW.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>k_value</code></td>
        <td><code>int</code></td>
        <td><p>number of closest points for neigthours definition in distance weight matrix computation.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>geometry_column</code></td>
        <td><code>str</code></td>
        <td><p>field storing the geometry column. If in string form (as loaded from a csv), it will be converted to Point objects. Default='coordinates'.</p></td>
        <td><code>&#39;geometry&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>hotspots (pd.DataFrame)</code></td>
      <td><p>Dataframe stored in the ProfileDynamics.hotspots attribute, storing the fdr thresholds, local moran-s Is, p and z values and the quadrant
in which each observation falls in a Moran's scatter plot.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">LISA_site_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">mode</span><span class="p">,</span>
                    <span class="n">distance_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">decay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">k_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">geometry_column</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs Hot-Spot analysis using Local Moran&#39;s I as Location Indicator of Spatial Association (LISA) with False Discovery Rate (fdr) correction for all the surveys.</span>
<span class="sd">        Please refer to PySAL package documentation for more info.</span>

<span class="sd">    Args:</span>
<span class="sd">        mode (str): If &#39;distance&#39;(Default), compute spatial weight matrix using a distance-band kernel, specified in distance_value parameter.</span>
<span class="sd">                                        If &#39;knn&#39;, spatial weight matrix uses a specified (k_value parameter) of k number closest points to compute weights.</span>
<span class="sd">                                        if &#39;idw&#39;, Inverse Distance Weigthing is used with the specified decay power (decay parameter) to compute weight.</span>

<span class="sd">        distance_value (int): values in meters (crs must be projected) used as distance band for neigthours definition in distance weight matrix computation.</span>
<span class="sd">        decay (int): power of decay to use with IDW.</span>
<span class="sd">        k_value (int): number of closest points for neigthours definition in distance weight matrix computation.</span>
<span class="sd">        geometry_column (str): field storing the geometry column. If in string form (as loaded from a csv), it will be converted to Point objects. Default=&#39;coordinates&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        hotspots (pd.DataFrame): Dataframe stored in the ProfileDynamics.hotspots attribute, storing the fdr thresholds, local moran-s Is, p and z values and the quadrant</span>
<span class="sd">        in which each observation falls in a Moran&#39;s scatter plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">hotspots</span> <span class="o">=</span> <span class="n">LISA_site_level</span><span class="p">(</span><span class="n">dh_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                                <span class="n">distance_value</span><span class="o">=</span><span class="n">distance_value</span><span class="p">,</span>
                                <span class="n">geometry_column</span><span class="o">=</span><span class="n">geometry_column</span><span class="p">,</span>
                                <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span>
                                <span class="n">k_value</span><span class="o">=</span><span class="n">k_value</span><span class="p">,</span>
                                <span class="n">crs_dict_string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">crs_dict_string</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.plot_alongshore_change">
<code class="highlight language-python"><span class="n">plot_alongshore_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">lod</span><span class="p">,</span> <span class="n">location_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dt_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax2_y_lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">img_type</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">from_land</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">from_origin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plots_spacing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">y_heat_bottom_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">heat_yticklabels_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">heat_xticklabels_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma_n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.plot_alongshore_change" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Display longshore altimetric and volumetric beach changes plots. A subset of locations and periods can be plotted. If LoD parameter is True (default), then white cells in the altimetric heatmap are values within LoD. Grey cells is no data or filtered-out points.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mode</code></td>
        <td><code>str</code></td>
        <td><p>If 'subset', only a subset of locations and dts are plotted. If 'all', all periods and locations are plotted. .</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lod</code></td>
        <td><code>pd.DataFrame, float, bool</code></td>
        <td><p>If a DataFRame is provided, it must be have a column named location with location codes and another called lod with lod values. If a float is provided, uses this value across all the serveys. If False is provided, then don't use LoD filters.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>location_subset</code></td>
        <td><code>list</code></td>
        <td><p>List of strings containing the location codes (e.g. wbl) to be plotted.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dt_subset</code></td>
        <td><code>list</code></td>
        <td><p>List of strings containing the period codes (e.g. dt_0) to be plotted.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ax2_y_lims</code></td>
        <td><code>tuple</code></td>
        <td><p>Limits of y-axis of alonghsore volumetric change plot. Default is (-8,5).</p></td>
        <td><code>(-8, 5)</code></td>
      </tr>
      <tr>
        <td><code>save</code></td>
        <td><code>bool</code></td>
        <td><p>If True, saves the plots in the specified save_path. False is default.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>save_path</code></td>
        <td><code>path</code></td>
        <td><p>Full path to a folder (e.g. C:\preferred\folder) where to save plots.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dpi</code></td>
        <td><code>int</code></td>
        <td><p>Resolution in Dot Per Inch (DPI) to save the images.</p></td>
        <td><code>300</code></td>
      </tr>
      <tr>
        <td><code>img_type</code></td>
        <td><code>str</code></td>
        <td><p>'.png','.pdf', '.ps', '.svg'. Format of the saved figures.</p></td>
        <td><code>&#39;.png&#39;</code></td>
      </tr>
      <tr>
        <td><code>from_land</code></td>
        <td><code>bool</code></td>
        <td><p>If True (default), cross-shore distances are transformed into landward distances, where 0 is the end of beachface.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>from_origin</code></td>
        <td><code>bool</code></td>
        <td><p>If True (default), transect IDS are transformed in alongshore distance from origin (tr_id=0). It requires regularly spaced transects.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Width and height (in inches) of the figure.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_scale</code></td>
        <td><code>float</code></td>
        <td><p>Scale of text. Default=1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>plots_spacing</code></td>
        <td><code>float</code></td>
        <td><p>Vertical spacing of the heatmap and alongshore change plots. Default = 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>bottom</code></td>
        <td><code>bool</code></td>
        <td><p>If True (default), rows are extended seaward too, up to y_heat_bottom_limit. If False, only distances from 0 to the first valid values will be added.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>y_heat_bottom_limit</code></td>
        <td><code>int</code></td>
        <td><p>Lower boundary distance (seaward) to extend all transects to.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>heat_yticklabels_freq</code></td>
        <td><code>int</code></td>
        <td><p>Plot a labels every n labels in the heatmap y axis.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>heat_xticklabels_freq</code></td>
        <td><code>int</code></td>
        <td><p>Plot a labels every n labels in the heatmap x axis.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>outliers</code></td>
        <td><code>bool</code></td>
        <td><p>When True, use the specified number of standard deviation to exclude outliers. If False, retain all the points.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>sigma_n</code></td>
        <td><code>int</code></td>
        <td><p>Number of standard deviation to use to exclude outliers (default=3).</p></td>
        <td><code>3</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_alongshore_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">,</span>
    <span class="n">lod</span><span class="p">,</span>
    <span class="n">location_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dt_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ax2_y_lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">img_type</span><span class="o">=</span><span class="s2">&quot;.png&quot;</span><span class="p">,</span>
    <span class="n">from_land</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">from_origin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">plots_spacing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">y_heat_bottom_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">heat_yticklabels_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">heat_xticklabels_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">outliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">sigma_n</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Display longshore altimetric and volumetric beach changes plots. A subset of locations and periods can be plotted. If LoD parameter is True (default), then white cells in the altimetric heatmap are values within LoD. Grey cells is no data or filtered-out points.</span>

<span class="sd">    Args:</span>
<span class="sd">        mode (str): If &#39;subset&#39;, only a subset of locations and dts are plotted. If &#39;all&#39;, all periods and locations are plotted. .</span>
<span class="sd">        lod (pd.DataFrame, float, bool): If a DataFRame is provided, it must be have a column named location with location codes and another called lod with lod values. If a float is provided, uses this value across all the serveys. If False is provided, then don&#39;t use LoD filters.</span>
<span class="sd">        location_subset (list): List of strings containing the location codes (e.g. wbl) to be plotted.</span>
<span class="sd">        dt_subset (list): List of strings containing the period codes (e.g. dt_0) to be plotted.</span>
<span class="sd">        ax2_y_lims (tuple): Limits of y-axis of alonghsore volumetric change plot. Default is (-8,5).</span>
<span class="sd">        save (bool): If True, saves the plots in the specified save_path. False is default.</span>
<span class="sd">        save_path (path): Full path to a folder (e.g. C:\\preferred\\folder\\) where to save plots.</span>
<span class="sd">        dpi (int): Resolution in Dot Per Inch (DPI) to save the images.</span>
<span class="sd">        img_type (str): &#39;.png&#39;,&#39;.pdf&#39;, &#39;.ps&#39;, &#39;.svg&#39;. Format of the saved figures.</span>
<span class="sd">        from_land (bool): If True (default), cross-shore distances are transformed into landward distances, where 0 is the end of beachface.</span>
<span class="sd">        from_origin (bool): If True (default), transect IDS are transformed in alongshore distance from origin (tr_id=0). It requires regularly spaced transects.</span>
<span class="sd">        fig_size (tuple): Width and height (in inches) of the figure.</span>
<span class="sd">        font_scale (float): Scale of text. Default=1.</span>
<span class="sd">        plots_spacing (float): Vertical spacing of the heatmap and alongshore change plots. Default = 0.</span>
<span class="sd">        bottom (bool): If True (default), rows are extended seaward too, up to y_heat_bottom_limit. If False, only distances from 0 to the first valid values will be added.</span>
<span class="sd">        y_heat_bottom_limit (int): Lower boundary distance (seaward) to extend all transects to.</span>
<span class="sd">        heat_yticklabels_freq (int): Plot a labels every n labels in the heatmap y axis.</span>
<span class="sd">        heat_xticklabels_freq (int): Plot a labels every n labels in the heatmap x axis.</span>
<span class="sd">        outliers (bool): When True, use the specified number of standard deviation to exclude outliers. If False, retain all the points.</span>
<span class="sd">        sigma_n (int): Number of standard deviation to use to exclude outliers (default=3).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">plot_alongshore_change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
        <span class="n">lod</span><span class="o">=</span><span class="n">lod</span><span class="p">,</span>
        <span class="n">full_specs_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_details</span><span class="p">,</span>
        <span class="n">return_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">location_subset</span><span class="o">=</span><span class="n">location_subset</span><span class="p">,</span>
        <span class="n">dt_subset</span><span class="o">=</span><span class="n">dt_subset</span><span class="p">,</span>
        <span class="n">ax2_y_lims</span><span class="o">=</span><span class="n">ax2_y_lims</span><span class="p">,</span>
        <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
        <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span><span class="p">,</span>
        <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
        <span class="n">img_type</span><span class="o">=</span><span class="n">img_type</span><span class="p">,</span>
        <span class="n">from_land</span><span class="o">=</span><span class="n">from_land</span><span class="p">,</span>
        <span class="n">from_origin</span><span class="o">=</span><span class="n">from_origin</span><span class="p">,</span>
        <span class="n">add_orient</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span>
        <span class="n">font_scale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">,</span>
        <span class="n">plots_spacing</span><span class="o">=</span><span class="n">plots_spacing</span><span class="p">,</span>
        <span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">,</span>
        <span class="n">y_heat_bottom_limit</span><span class="o">=</span><span class="n">y_heat_bottom_limit</span><span class="p">,</span>
        <span class="n">transect_spacing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">transects_spacing</span><span class="p">,</span>
        <span class="n">along_transect_sampling_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">sampling_step</span><span class="p">,</span>
        <span class="n">heat_yticklabels_freq</span><span class="o">=</span><span class="n">heat_yticklabels_freq</span><span class="p">,</span>
        <span class="n">heat_xticklabels_freq</span><span class="o">=</span><span class="n">heat_xticklabels_freq</span><span class="p">,</span>
        <span class="n">outliers</span><span class="o">=</span><span class="n">outliers</span><span class="p">,</span>
        <span class="n">sigma_n</span><span class="o">=</span><span class="n">sigma_n</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.plot_location_ebcds">
<code class="highlight language-python"><span class="n">plot_location_ebcds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc_order</span><span class="p">,</span> <span class="n">palette_dyn_states</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Erosional&#39;</span><span class="p">:</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;Recovery&#39;</span><span class="p">:</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;Depositional&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;Vulnerability&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">},</span> <span class="n">b_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Erosional&#39;</span><span class="p">,</span> <span class="s1">&#39;Recovery&#39;</span><span class="p">,</span> <span class="s1">&#39;Depositional&#39;</span><span class="p">,</span> <span class="s1">&#39;Vulnerability&#39;</span><span class="p">],</span> <span class="n">xticks_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.plot_location_ebcds" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Plot location-specific Empirical Beachface Cluster Dynamics indices and their trend in the form as a plus sign for increasing trend and a minus for decreasing trends.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>loc_order</code></td>
        <td><code>list</code></td>
        <td><p>List of location codes specifying the order (left-to-right) to plot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>palette_dyn_states</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary where keys are the behaviours and values the color to be assigned, like {"Erosional":"r","Recovery":"g","Depositional":"b","Vulnerability":"purple"}.</p></td>
        <td><code>{&#39;Erosional&#39;: &#39;r&#39;, &#39;Recovery&#39;: &#39;g&#39;, &#39;Depositional&#39;: &#39;b&#39;, &#39;Vulnerability&#39;: &#39;purple&#39;}</code></td>
      </tr>
      <tr>
        <td><code>b_order</code></td>
        <td><code>list) </code></td>
        <td><p>List of behaviours specifying the order (left-to-right) to plot. Default is ["Erosional","Recovery","Depositional","Vulnerability"].</p></td>
        <td><code>[&#39;Erosional&#39;, &#39;Recovery&#39;, &#39;Depositional&#39;, &#39;Vulnerability&#39;]</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>Width and height (in inches) of the figure.</p></td>
        <td><code>(8, 4)</code></td>
      </tr>
      <tr>
        <td><code>xticks_labels</code></td>
        <td><code>list</code></td>
        <td><p>If provided, rename the x labels of the plot (locations) from left to right, like ["Marengo","St. Leo"].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_scale</code></td>
        <td><code>float</code></td>
        <td><p>Scale of text. Default=0.8.</p></td>
        <td><code>0.8</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_location_ebcds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">loc_order</span><span class="p">,</span>
                    <span class="n">palette_dyn_states</span> <span class="o">=</span><span class="p">{</span><span class="s2">&quot;Erosional&quot;</span><span class="p">:</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="s2">&quot;Recovery&quot;</span><span class="p">:</span><span class="s2">&quot;g&quot;</span><span class="p">,</span><span class="s2">&quot;Depositional&quot;</span><span class="p">:</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;Vulnerability&quot;</span><span class="p">:</span><span class="s2">&quot;purple&quot;</span><span class="p">},</span>
                    <span class="n">b_order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Erosional&quot;</span><span class="p">,</span><span class="s2">&quot;Recovery&quot;</span><span class="p">,</span><span class="s2">&quot;Depositional&quot;</span><span class="p">,</span><span class="s2">&quot;Vulnerability&quot;</span><span class="p">],</span>
                    <span class="n">xticks_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                    <span class="n">font_scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot location-specific Empirical Beachface Cluster Dynamics indices and their trend in the form as a plus sign for increasing trend and a minus for decreasing trends.</span>

<span class="sd">    Args:</span>
<span class="sd">        loc_order (list): List of location codes specifying the order (left-to-right) to plot.</span>
<span class="sd">        palette_dyn_states (dict): Dictionary where keys are the behaviours and values the color to be assigned, like {&quot;Erosional&quot;:&quot;r&quot;,&quot;Recovery&quot;:&quot;g&quot;,&quot;Depositional&quot;:&quot;b&quot;,&quot;Vulnerability&quot;:&quot;purple&quot;}.</span>
<span class="sd">        b_order (list) : List of behaviours specifying the order (left-to-right) to plot. Default is [&quot;Erosional&quot;,&quot;Recovery&quot;,&quot;Depositional&quot;,&quot;Vulnerability&quot;].</span>
<span class="sd">        figsize (tuple): Width and height (in inches) of the figure.</span>
<span class="sd">        xticks_labels (list): If provided, rename the x labels of the plot (locations) from left to right, like [&quot;Marengo&quot;,&quot;St. Leo&quot;].</span>
<span class="sd">        font_scale (float): Scale of text. Default=0.8.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">sb</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

    <span class="n">plot_bars</span><span class="o">=</span><span class="n">sb</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">location_ebcds</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">location_ebcds</span><span class="o">.</span><span class="n">coastal_markov_idx</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;states_labels&quot;</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="n">b_order</span><span class="p">,</span>
              <span class="n">order</span><span class="o">=</span><span class="n">loc_order</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette_dyn_states</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">xticks_labels</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">xticks_labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;e-BCD&quot;</span><span class="p">)</span>

    <span class="n">txt_heights</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">]</span>

    <span class="n">signs</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">b_order</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">loc_order</span><span class="p">:</span>
            <span class="n">sign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">location_ebcds</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location == &#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&#39; &amp; states_labels==&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sign</span><span class="o">.</span><span class="n">values</span>
            <span class="n">signs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>


    <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">txt_height</span><span class="p">,</span><span class="n">sign</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">,</span><span class="n">txt_heights</span><span class="p">,</span><span class="n">signs</span><span class="p">):</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_xy</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
             <span class="n">txt_height</span> <span class="o">-</span> <span class="mf">0.095</span><span class="p">,</span>
             <span class="n">sign</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
             <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
             <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
               <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
               <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;heavy&#39;</span><span class="p">)</span>

    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">[:],</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">[:],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.plot_lod_normality_check">
<code class="highlight language-python"><span class="n">plot_lod_normality_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qq_xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qq_ylims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.plot_lod_normality_check" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Plots the error density histograms and Q-Q plot of absolute error along with Saphiro-Wilk and D'Agostino-Pearson tests.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>locations</code></td>
        <td><code>list</code></td>
        <td><p>Location codes to show plots of.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>alpha</code></td>
        <td><code>int</code></td>
        <td><p>p-value threshold to define significance of statistical tests (default=0.05).</p></td>
        <td><code>0.05</code></td>
      </tr>
      <tr>
        <td><code>xlims</code></td>
        <td><code>tuple</code></td>
        <td><p>Min and max values for the histogram plot x axis.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ylim</code></td>
        <td><code>tuple</code></td>
        <td><p>Min and max values for the histogram plot y axis.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>qq_xlims</code></td>
        <td><code>tuple</code></td>
        <td><p>Min and max values for the q-q plot x axis.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>qq_ylims</code></td>
        <td><code>tuple</code></td>
        <td><p>Min and max values for the q-q plot y axis.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>Width and height (in inches) of the figure.</p></td>
        <td><code>(7, 4)</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_lod_normality_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">qq_xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">qq_ylims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Plots the error density histograms and Q-Q plot of absolute error along with Saphiro-Wilk and D&#39;Agostino-Pearson tests.</span>

<span class="sd">    Args:</span>
<span class="sd">        locations (list): Location codes to show plots of.</span>
<span class="sd">        alpha (int): p-value threshold to define significance of statistical tests (default=0.05).</span>
<span class="sd">        xlims (tuple): Min and max values for the histogram plot x axis.</span>
<span class="sd">        ylim (tuple): Min and max values for the histogram plot y axis.</span>
<span class="sd">        qq_xlims (tuple): Min and max values for the q-q plot x axis.</span>
<span class="sd">        qq_ylims (tuple): Min and max values for the q-q plot y axis.</span>
<span class="sd">        figsize (tuple): Width and height (in inches) of the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lod_created</span> <span class="o">!=</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;LoD dataset has not been created.</span><span class="se">\</span>
<span class="s2">        Please run the profile extraction again, providing transects specifically placed in pseudo-invariant areas, in order to create the LoD data and statistics.&quot;</span><span class="p">)</span>

    <span class="n">plot_lod_normality_check</span><span class="p">(</span><span class="n">multitemp_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lod_dh</span><span class="p">,</span>
        <span class="n">lod_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lod_df</span><span class="p">,</span>
        <span class="n">details_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_details</span><span class="p">,</span>
        <span class="n">locations</span><span class="o">=</span><span class="n">locations</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">xlims</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
        <span class="n">qq_xlims</span><span class="o">=</span><span class="n">qq_xlims</span><span class="p">,</span>
        <span class="n">qq_ylims</span><span class="o">=</span><span class="n">qq_ylims</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.plot_mec_evolution">
<code class="highlight language-python"><span class="n">plot_mec_evolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%y&#39;</span><span class="p">,</span> <span class="n">scale_mode</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">x_diff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dates_step</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">x_limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">),</span> <span class="n">x_binning</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">img_type</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name_fig</span><span class="o">=</span><span class="s1">&#39;Mean Elevation Changes&#39;</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.plot_mec_evolution" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Plot all locations period-specific and cumulative MECs side by side in a comparable way.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>loc_order</code></td>
        <td><code>list</code></td>
        <td><p>List of location codes specifying the order (left-to-right) to plot timeseries.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>date_format</code></td>
        <td><code>str</code></td>
        <td><p>Format of the output date. Must be in the datetime.strptime format, like "%d.%m.%y".</p></td>
        <td><code>&#39;%d.%m.%y&#39;</code></td>
      </tr>
      <tr>
        <td><code>scale_mode</code></td>
        <td><code>str</code></td>
        <td><p>If ""equal", each location x axis limits are the same. This is useful for reliable visual comparison of MEC. If "auto", each location will have different x limits optimised for each location.</p></td>
        <td><code>&#39;equal&#39;</code></td>
      </tr>
      <tr>
        <td><code>x_diff</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary where keys are location codes and values are x_min and x_max in a list, like {'leo': [-0.12, 0.1]}. If provided, this allows to keep all the locations x axis equal, except the locations specified in this dictionary.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dates_step</code></td>
        <td><code>int</code></td>
        <td><p>Plot one date label ever n in the y-axis.</p></td>
        <td><code>50</code></td>
      </tr>
      <tr>
        <td><code>x_limits</code></td>
        <td><code>tuple</code></td>
        <td><p>A tuple containing x_min and x_max to apply to all the locations x axis (except those specified with x_diff, if any).</p></td>
        <td><code>(-0.41, 0.41)</code></td>
      </tr>
      <tr>
        <td><code>x_binning</code></td>
        <td><code>int</code></td>
        <td><p>Plot one label ever n in the locations x-axis.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>figure_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Width and height (in inches) of the figure.</p></td>
        <td><code>(7, 4)</code></td>
      </tr>
      <tr>
        <td><code>font_scale</code></td>
        <td><code>float</code></td>
        <td><p>Scale of text. Default=1.</p></td>
        <td><code>0.75</code></td>
      </tr>
      <tr>
        <td><code>dpi</code></td>
        <td><code>int</code></td>
        <td><p>Resolution in Dot Per Inch (DPI) to save the images.</p></td>
        <td><code>300</code></td>
      </tr>
      <tr>
        <td><code>img_type</code></td>
        <td><code>str</code></td>
        <td><p>'.png','.pdf', '.ps', '.svg'. Format of the saved figures.</p></td>
        <td><code>&#39;.png&#39;</code></td>
      </tr>
      <tr>
        <td><code>save_fig</code></td>
        <td><code>bool</code></td>
        <td><p>If True, saves the plots in the specified save_path. False is default.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>name_fig</code></td>
        <td><code>str</code></td>
        <td><p>Name to give to the figure to be saved.</p></td>
        <td><code>&#39;Mean Elevation Changes&#39;</code></td>
      </tr>
      <tr>
        <td><code>save_path</code></td>
        <td><code>str</code></td>
        <td><p>Full path to a folder, like r"C:\preferred\folder\", where to save the figure.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_mec_evolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">loc_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">.%m.%y&quot;</span><span class="p">,</span>
    <span class="n">scale_mode</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span>
    <span class="n">x_diff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dates_step</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">x_limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">),</span>
    <span class="n">x_binning</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">figure_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">font_scale</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">img_type</span><span class="o">=</span><span class="s2">&quot;.png&quot;</span><span class="p">,</span>
    <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">name_fig</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mean Elevation Changes&quot;</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot all locations period-specific and cumulative MECs side by side in a comparable way.</span>

<span class="sd">    Args:</span>
<span class="sd">        loc_order (list): List of location codes specifying the order (left-to-right) to plot timeseries.</span>
<span class="sd">        date_format (str): Format of the output date. Must be in the datetime.strptime format, like &quot;%d.%m.%y&quot;.</span>
<span class="sd">        scale_mode (str): If &quot;&quot;equal&quot;, each location x axis limits are the same. This is useful for reliable visual comparison of MEC. If &quot;auto&quot;, each location will have different x limits optimised for each location.</span>
<span class="sd">        x_diff (dict): A dictionary where keys are location codes and values are x_min and x_max in a list, like {&#39;leo&#39;: [-0.12, 0.1]}. If provided, this allows to keep all the locations x axis equal, except the locations specified in this dictionary.</span>
<span class="sd">        dates_step (int): Plot one date label ever n in the y-axis.</span>
<span class="sd">        x_limits (tuple): A tuple containing x_min and x_max to apply to all the locations x axis (except those specified with x_diff, if any).</span>
<span class="sd">        x_binning (int): Plot one label ever n in the locations x-axis.</span>
<span class="sd">        figure_size (tuple): Width and height (in inches) of the figure.</span>
<span class="sd">        font_scale (float): Scale of text. Default=1.</span>
<span class="sd">        dpi (int): Resolution in Dot Per Inch (DPI) to save the images.</span>
<span class="sd">        img_type (str): &#39;.png&#39;,&#39;.pdf&#39;, &#39;.ps&#39;, &#39;.svg&#39;. Format of the saved figures.</span>
<span class="sd">        save_fig (bool): If True, saves the plots in the specified save_path. False is default.</span>
<span class="sd">        name_fig (str): Name to give to the figure to be saved.</span>
<span class="sd">        save_path (str): Full path to a folder, like r&quot;C:\\preferred\\folder\\&quot;, where to save the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">plot_mec_evolution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location_volumetrics</span><span class="p">,</span>
        <span class="n">location_field</span><span class="o">=</span><span class="s1">&#39;location&#39;</span><span class="p">,</span>
        <span class="n">loc_order</span><span class="o">=</span><span class="n">loc_order</span><span class="p">,</span>
        <span class="n">date_from_field</span><span class="o">=</span><span class="s2">&quot;date_from&quot;</span><span class="p">,</span>
        <span class="n">date_to_field</span><span class="o">=</span><span class="s2">&quot;date_to&quot;</span><span class="p">,</span>
        <span class="n">date_format</span><span class="o">=</span><span class="n">date_format</span><span class="p">,</span>
        <span class="n">scale_mode</span><span class="o">=</span><span class="n">scale_mode</span><span class="p">,</span>
        <span class="n">x_diff</span><span class="o">=</span><span class="n">x_diff</span><span class="p">,</span>
        <span class="n">dates_step</span><span class="o">=</span><span class="n">dates_step</span><span class="p">,</span>
        <span class="n">x_limits</span><span class="o">=</span><span class="n">x_limits</span><span class="p">,</span>
        <span class="n">x_binning</span><span class="o">=</span><span class="n">x_binning</span><span class="p">,</span>
        <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span>
        <span class="n">font_scale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">,</span>
        <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
        <span class="n">img_type</span><span class="o">=</span><span class="n">img_type</span><span class="p">,</span>
        <span class="n">save_fig</span><span class="o">=</span><span class="n">save_fig</span><span class="p">,</span>
        <span class="n">name_fig</span><span class="o">=</span><span class="n">name_fig</span><span class="p">,</span>
        <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.plot_single_loc">
<code class="highlight language-python"><span class="n">plot_single_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc_subset</span><span class="p">,</span> <span class="n">colors_dict</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">out_date_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Survey date&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Volume change (m³)&#39;</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="s1">&#39;Volumetric Timeseries&#39;</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.plot_single_loc" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Volume change timeseries of a location. Solid line are period-specific change and dashed ones are the cumulative change from the start of the monitoring.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>loc_subset</code></td>
        <td><code>str</code></td>
        <td><p>Location code of of the transect to visualise.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>colors_dict</code></td>
        <td><code>int</code></td>
        <td><p>Id of the transect to visualise.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>Width and height (in inches) of the figure.</p></td>
        <td><code>(8.5, 4)</code></td>
      </tr>
      <tr>
        <td><code>linewidth</code></td>
        <td><code>float</code></td>
        <td><p>Width of the lines.</p></td>
        <td><code>1.5</code></td>
      </tr>
      <tr>
        <td><code>out_date_format</code></td>
        <td><code>str</code></td>
        <td><p>Format of the output date. Must be in the datetime.strptime format, like "%d/%m/%Y".</p></td>
        <td><code>&#39;%d/%m/%Y&#39;</code></td>
      </tr>
      <tr>
        <td><code>xlabel</code></td>
        <td><code>str</code></td>
        <td><p>Label of the x axis.</p></td>
        <td><code>&#39;Survey date&#39;</code></td>
      </tr>
      <tr>
        <td><code>ylabel</code></td>
        <td><code>str</code></td>
        <td><p>Label of the y axis.</p></td>
        <td><code>&#39;Volume change (m³)&#39;</code></td>
      </tr>
      <tr>
        <td><code>suptitle</code></td>
        <td><code>str</code></td>
        <td><p>Title of the plot.</p></td>
        <td><code>&#39;Volumetric Timeseries&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_single_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">loc_subset</span><span class="p">,</span>
                    <span class="n">colors_dict</span><span class="p">,</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                    <span class="n">out_date_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">,</span>
                    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Survey date&quot;</span> <span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Volume change (m³)&quot;</span><span class="p">,</span>
                    <span class="n">suptitle</span><span class="o">=</span><span class="s2">&quot;Volumetric Timeseries&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Volume change timeseries of a location. Solid line are period-specific change and dashed ones are the cumulative change from the start of the monitoring.</span>

<span class="sd">    Args:</span>
<span class="sd">        loc_subset (str): Location code of of the transect to visualise.</span>
<span class="sd">        colors_dict (int): Id of the transect to visualise.</span>
<span class="sd">        figsize (tuple): Width and height (in inches) of the figure.</span>
<span class="sd">        linewidth (float): Width of the lines.</span>
<span class="sd">        out_date_format (str): Format of the output date. Must be in the datetime.strptime format, like &quot;%d/%m/%Y&quot;.</span>
<span class="sd">        xlabel (str): Label of the x axis.</span>
<span class="sd">        ylabel (str): Label of the y axis.</span>
<span class="sd">        suptitle (str): Title of the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">plot_single_loc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location_volumetrics</span><span class="p">,</span>
                    <span class="n">loc_subset</span><span class="o">=</span><span class="n">loc_subset</span><span class="p">,</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                    <span class="n">colors_dict</span><span class="o">=</span><span class="n">colors_dict</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                    <span class="n">out_date_format</span><span class="o">=</span><span class="n">out_date_format</span><span class="p">,</span>
                    <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
                    <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.plot_trans_matrices">
<code class="highlight language-python"><span class="n">plot_trans_matrices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relabel_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Erosional&#39;</span><span class="p">,</span> <span class="s1">&#39;Recovery&#39;</span><span class="p">,</span> <span class="s1">&#39;Depositional&#39;</span><span class="p">,</span> <span class="s1">&#39;Vulnerability&#39;</span><span class="p">],</span> <span class="n">cmaps</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="s1">&#39;Greens&#39;</span><span class="p">,</span> <span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="s1">&#39;PuRd&#39;</span><span class="p">],</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">heat_annot_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">save_it</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_output</span><span class="o">=</span><span class="s1">&#39;C:</span><span class="se">\\\\</span><span class="s1">your</span><span class="se">\\\\</span><span class="s1">preferred</span><span class="se">\\\\</span><span class="s1">folder</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.plot_trans_matrices" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Plot location-specific first-order stochastic matrices, representing the probability of each transition of a point (discretised into magnitude of change classes) of going from an initial state (matrices row) to a second state (matrices column) in one time period. These probabilities are the absis for the computation of the e-BCDs</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>relabel_dict</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary where keys are the magnitude of change classes and values a corresponding abbreviation, like {'Undefined_deposition': 'ue','Undefined_erosion': 'ue', 'Small_deposition': 'sd'}. This is useful in case of long names and abbreviations allows a much better visualisation.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>titles</code></td>
        <td><code>list</code></td>
        <td><p>List of names to assign to each submatrices, which define the behaviour of each matrices transitions. Default is ["Erosional", "Recovery", "Depositional", "Vulnerability"].</p></td>
        <td><code>[&#39;Erosional&#39;, &#39;Recovery&#39;, &#39;Depositional&#39;, &#39;Vulnerability&#39;]</code></td>
      </tr>
      <tr>
        <td><code>cmaps</code></td>
        <td><code>list) </code></td>
        <td><p>List of color ramps to assign to each matrices. It must be in the same order as specified in the titles parameter. Default is ["Reds", "Greens", "Blues", "PuRd"].</p></td>
        <td><code>[&#39;Reds&#39;, &#39;Greens&#39;, &#39;Blues&#39;, &#39;PuRd&#39;]</code></td>
      </tr>
      <tr>
        <td><code>fig_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Width and height (in inches) of the figure.</p></td>
        <td><code>(6, 4)</code></td>
      </tr>
      <tr>
        <td><code>heat_annot_size</code></td>
        <td><code>int</code></td>
        <td><p>Size of the annotations (probabilities) inside each matrices cells.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>font_scale</code></td>
        <td><code>float</code></td>
        <td><p>Scale of text. Default=1.</p></td>
        <td><code>0.75</code></td>
      </tr>
      <tr>
        <td><code>dpi</code></td>
        <td><code>int</code></td>
        <td><p>Resolution in Dot Per Inch (DPI) to save the images.</p></td>
        <td><code>300</code></td>
      </tr>
      <tr>
        <td><code>save_it</code></td>
        <td><code>bool</code></td>
        <td><p>If True, saves the plots in the specified save_path. False is default.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>save_output</code></td>
        <td><code>str</code></td>
        <td><p>Full path to a folder, like r"C:\preferred\folder\", where to save the figure.</p></td>
        <td><code>&#39;C:\\\\your\\\\preferred\\\\folder\\\\&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_trans_matrices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">relabel_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Erosional&quot;</span><span class="p">,</span> <span class="s2">&quot;Recovery&quot;</span><span class="p">,</span> <span class="s2">&quot;Depositional&quot;</span><span class="p">,</span> <span class="s2">&quot;Vulnerability&quot;</span><span class="p">],</span>
                    <span class="n">cmaps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Reds&quot;</span><span class="p">,</span> <span class="s2">&quot;Greens&quot;</span><span class="p">,</span> <span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="s2">&quot;PuRd&quot;</span><span class="p">],</span>
                    <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                    <span class="n">heat_annot_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">font_scale</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                    <span class="n">save_it</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">save_output</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">your</span><span class="se">\\</span><span class="s2">preferred</span><span class="se">\\</span><span class="s2">folder</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot location-specific first-order stochastic matrices, representing the probability of each transition of a point (discretised into magnitude of change classes) of going from an initial state (matrices row) to a second state (matrices column) in one time period. These probabilities are the absis for the computation of the e-BCDs</span>

<span class="sd">    Args:</span>
<span class="sd">        relabel_dict (dict): Dictionary where keys are the magnitude of change classes and values a corresponding abbreviation, like {&#39;Undefined_deposition&#39;: &#39;ue&#39;,&#39;Undefined_erosion&#39;: &#39;ue&#39;, &#39;Small_deposition&#39;: &#39;sd&#39;}. This is useful in case of long names and abbreviations allows a much better visualisation.</span>
<span class="sd">        titles (list): List of names to assign to each submatrices, which define the behaviour of each matrices transitions. Default is [&quot;Erosional&quot;, &quot;Recovery&quot;, &quot;Depositional&quot;, &quot;Vulnerability&quot;].</span>
<span class="sd">        cmaps (list) : List of color ramps to assign to each matrices. It must be in the same order as specified in the titles parameter. Default is [&quot;Reds&quot;, &quot;Greens&quot;, &quot;Blues&quot;, &quot;PuRd&quot;].</span>
<span class="sd">        fig_size (tuple): Width and height (in inches) of the figure.</span>
<span class="sd">        heat_annot_size (int): Size of the annotations (probabilities) inside each matrices cells.</span>
<span class="sd">        font_scale (float): Scale of text. Default=1.</span>
<span class="sd">        dpi (int): Resolution in Dot Per Inch (DPI) to save the images.</span>
<span class="sd">        save_it (bool): If True, saves the plots in the specified save_path. False is default.</span>
<span class="sd">        save_output (str): Full path to a folder, like r&quot;C:\\preferred\\folder\\&quot;, where to save the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_labelled</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">std_excluding_nnn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transitions_matrices</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">exclude_outliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">std_excluding_nnn</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">f</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax_i</span><span class="p">,</span> <span class="n">heat</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">cmap_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">transitions_matrices</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span> <span class="n">titles</span><span class="p">,</span> <span class="n">cmaps</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">relabel_dict</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
                <span class="n">heat</span><span class="o">=</span><span class="n">heat</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">relabel_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">relabel_dict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="n">sb</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
                <span class="n">heat</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_i</span><span class="p">,</span>
                <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">linecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
                <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">vmax</span><span class="o">=</span><span class="n">exclude_outliers</span><span class="p">,</span>
                <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">heat_annot_size</span><span class="p">},</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax_i</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax_i</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loc</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">markov_details</span><span class="p">[</span><span class="n">loc</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, t=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">markov_details</span><span class="p">[</span><span class="n">loc</span><span class="p">][</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, trans:</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">markov_details</span><span class="p">[</span><span class="n">loc</span><span class="p">][</span><span class="s1">&#39;n_transitions&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">) &quot;</span><span class="p">)</span>
            <span class="n">title</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">])</span>
            <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">save_it</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">save_output</span><span class="si">}{</span><span class="n">loc</span><span class="si">}</span><span class="s2">_sub_matrices_.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.plot_transect_mecs">
<code class="highlight language-python"><span class="n">plot_transect_mecs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">tr_id</span><span class="p">,</span> <span class="n">lod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.plot_transect_mecs" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Barplots summarising MEC of each transect across time and regressionplot.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>location</code></td>
        <td><code>str</code></td>
        <td><p>Location code of of the transect to visualise.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tr_id</code></td>
        <td><code>int</code></td>
        <td><p>Id of the transect to visualise.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lod</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>If provided, filter dataset using survey-specific LoDs.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>Width and height (in inches) of the figure.</p></td>
        <td><code>(10, 5)</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_transect_mecs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">tr_id</span><span class="p">,</span> <span class="n">lod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot; Barplots summarising MEC of each transect across time and regressionplot.</span>

<span class="sd">    Args:</span>
<span class="sd">        location (str): Location code of of the transect to visualise.</span>
<span class="sd">        tr_id (int): Id of the transect to visualise.</span>
<span class="sd">        lod (pd.DataFrame): If provided, filter dataset using survey-specific LoDs.</span>
<span class="sd">        figsize (tuple): Width and height (in inches) of the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">details</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_details</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="n">full_loc</span><span class="o">=</span><span class="n">details</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;loc_full&quot;</span><span class="p">]</span>

    <span class="n">f</span><span class="p">,</span><span class="n">axs</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                      <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and tr_id==</span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">filter_used</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">class_filter</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>


    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lod</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using LoDs.&quot;</span><span class="p">)</span>
        <span class="n">lods</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lod_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)[[</span><span class="s2">&quot;dt&quot;</span><span class="p">,</span><span class="s2">&quot;lod&quot;</span><span class="p">]]</span>
        <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">lods</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;dh_abs&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">dh_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">dh_i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">dh</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;dh&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dh_abs</span><span class="o">&lt;</span><span class="n">data</span><span class="o">.</span><span class="n">lod</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">dh</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">filter_used</span> <span class="o">!=</span> <span class="s2">&quot;no_filters_applied&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Statistics are computed based on the following classes only: </span><span class="si">{</span><span class="n">filter_used</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">mecs</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dh</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">mecs</span><span class="o">=</span><span class="n">mecs</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">mecs</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;mec&#39;</span><span class="p">]</span>
    <span class="n">mecs</span><span class="p">[</span><span class="s1">&#39;dt_i&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mecs</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mecs</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="n">mecs</span><span class="p">[</span><span class="s1">&#39;net_change&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;positive&#39;</span> <span class="k">if</span> <span class="n">mec_i</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;negative&#39;</span> <span class="k">for</span> <span class="n">mec_i</span> <span class="ow">in</span> <span class="n">mecs</span><span class="o">.</span><span class="n">mec</span><span class="p">]</span>


    <span class="n">barplot</span><span class="o">=</span><span class="n">sb</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mecs</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;dt_i&#39;</span><span class="p">]),</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;mec&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;net_change&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;positive&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">:</span> <span class="s1">&#39;r&#39;</span><span class="p">})</span>

    <span class="n">barplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Time period (dt)&quot;</span><span class="p">)</span>
    <span class="n">barplot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Mean Elevation Change (m)&quot;</span><span class="p">)</span>
    <span class="n">barplot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Barplot&#39;</span><span class="p">)</span>

    <span class="n">trend</span><span class="o">=</span><span class="n">sb</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mecs</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;dt_i&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mec&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mecs</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mec&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">trend</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trend&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;dh_abs&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;dh_abs&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Location: </span><span class="si">{</span><span class="n">full_loc</span><span class="si">}</span><span class="se">\n</span><span class="s2">Transect: </span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">);</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.plot_transects">
<code class="highlight language-python"><span class="n">plot_transects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">tr_id</span><span class="p">,</span> <span class="n">classified</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">details_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sand&#39;</span><span class="p">:</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;veg&#39;</span><span class="p">:</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;no_sand&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">})</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.plot_transects" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Visualise elevation profile changes between pre and post dates in selected locations, transect ids and time periods. If the data has been classified, it can also see what class each point was classified into.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>if classified=False, the points that have been filtered out will not be displayed. If classified=True, then all points will be plotted. This is done to have a visual understanding of the cleaning procedure applied and appreciate what is actually retained to compute change statistics.</p>
</div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>location</code></td>
        <td><code>str</code></td>
        <td><p>Location code of of the transect to visualise.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tr_id</code></td>
        <td><code>int</code></td>
        <td><p>Id of the transect to visualise.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>classified</code></td>
        <td><code>bool</code></td>
        <td><p>If True, colour the points (set palette argument to control the colors) based on class.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dt</code></td>
        <td><code>list</code></td>
        <td><p>List of time periods (dt) to plot, like ['dt_0', 'dt_4', 'dt_2'].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>from_date</code></td>
        <td><code>str</code></td>
        <td><p>Date of the pre-survey in raw format (yyyymmdd).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>to_date</code></td>
        <td><code>str</code></td>
        <td><p>Date of the pre-survey (yyyymmdd).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>Width and height (in inches) of the figure.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary where keys are class names and values the assigned colors in matplotlib-understandable format, like {"sand": "r", "water": "b", "veg": "g", "no_sand": "k"}.</p></td>
        <td><code>{&#39;sand&#39;: &#39;r&#39;, &#39;water&#39;: &#39;b&#39;, &#39;veg&#39;: &#39;g&#39;, &#39;no_sand&#39;: &#39;k&#39;}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_transects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">tr_id</span><span class="p">,</span> <span class="n">classified</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">details_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span><span class="p">{</span><span class="s2">&quot;sand&quot;</span><span class="p">:</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;veg&quot;</span><span class="p">:</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;no_sand&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span><span class="p">}):</span>
    <span class="sd">&quot;&quot;&quot;Visualise elevation profile changes between pre and post dates in selected locations, transect ids and time periods. If the data has been classified, it can also see what class each point was classified into.</span>

<span class="sd">    Warning:</span>
<span class="sd">        if classified=False, the points that have been filtered out will not be displayed. If classified=True, then all points will be plotted. This is done to have a visual understanding of the cleaning procedure applied and appreciate what is actually retained to compute change statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        location (str): Location code of of the transect to visualise.</span>
<span class="sd">        tr_id (int): Id of the transect to visualise.</span>
<span class="sd">        classified (bool): If True, colour the points (set palette argument to control the colors) based on class.</span>
<span class="sd">        dt (list): List of time periods (dt) to plot, like [&#39;dt_0&#39;, &#39;dt_4&#39;, &#39;dt_2&#39;].</span>
<span class="sd">        from_date (str): Date of the pre-survey in raw format (yyyymmdd).</span>
<span class="sd">        to_date (str): Date of the pre-survey (yyyymmdd).</span>
<span class="sd">        figsize (tuple): Width and height (in inches) of the figure.</span>
<span class="sd">        palette (dict): Dictionary where keys are class names and values the assigned colors in matplotlib-understandable format, like {&quot;sand&quot;: &quot;r&quot;, &quot;water&quot;: &quot;b&quot;, &quot;veg&quot;: &quot;g&quot;, &quot;no_sand&quot;: &quot;k&quot;}.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dt</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">periods</span><span class="o">=</span><span class="n">dt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">periods</span><span class="o">=</span><span class="p">[</span><span class="n">dt</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">dt_i</span> <span class="ow">in</span> <span class="n">periods</span><span class="p">:</span>
            <span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

            <span class="n">details</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_details</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and dt == &#39;</span><span class="si">{</span><span class="n">dt_i</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="n">full_loc</span><span class="o">=</span><span class="n">details</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;loc_full&quot;</span><span class="p">]</span>
            <span class="n">from_date</span><span class="o">=</span><span class="n">details</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;date_pre&quot;</span><span class="p">]</span>
            <span class="n">to_date</span><span class="o">=</span><span class="n">details</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;date_post&quot;</span><span class="p">]</span>


            <span class="k">if</span> <span class="n">classified</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and tr_id==</span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2"> and dt==&#39;</span><span class="si">{</span><span class="n">dt_i</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

                <span class="n">sb</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z_pre&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;z_pre&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pre&#39;</span><span class="p">)</span>

                <span class="n">sb</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z_post&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;z_post&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Post&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">classified</span><span class="p">:</span>
                <span class="n">from_classed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and tr_id==</span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2"> and raw_date==</span><span class="si">{</span><span class="n">from_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">to_classed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and tr_id==</span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2"> and raw_date==</span><span class="si">{</span><span class="n">to_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">sb</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">from_classed</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;pt_class&#39;</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">from_classed</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pre&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


                <span class="n">sb</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">to_classed</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;pt_class&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">to_classed</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Post&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;classified&#39; parameter must be either True or False.&quot;</span><span class="p">)</span>



            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation (m)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance alongshore (m)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Location: </span><span class="si">{</span><span class="n">full_loc</span><span class="si">}</span><span class="se">\n</span><span class="s2">Transect: </span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="se">\n</span><span class="s2">From </span><span class="si">{</span><span class="n">from_date</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_date</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">dt_i</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">);</span>

    <span class="k">elif</span> <span class="n">dt</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">from_date</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">to_date</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

            <span class="n">full_loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_details</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;loc_full&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">classified</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">data_pre</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and tr_id==</span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2"> and date_pre == </span><span class="si">{</span><span class="n">from_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">data_post</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dh_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and tr_id==</span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2"> and date_post == </span><span class="si">{</span><span class="n">to_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">sb</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_pre</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z_pre&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_pre</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;z_pre&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pre&#39;</span><span class="p">)</span>

                <span class="n">sb</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_post</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z_post&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_post</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;z_post&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Post&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">classified</span><span class="p">:</span>

                <span class="n">from_classed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and tr_id==</span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2"> and raw_date==</span><span class="si">{</span><span class="n">from_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">to_classed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ProfileSet</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location==&#39;</span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&#39; and tr_id==</span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="s2"> and raw_date==</span><span class="si">{</span><span class="n">to_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">sb</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">from_classed</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;pt_class&#39;</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">from_classed</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pre&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


                <span class="n">sb</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">to_classed</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;pt_class&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">to_classed</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Post&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation (m)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance alongshore (m)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Location: </span><span class="si">{</span><span class="n">full_loc</span><span class="si">}</span><span class="se">\n</span><span class="s2">Transect: </span><span class="si">{</span><span class="n">tr_id</span><span class="si">}</span><span class="se">\n</span><span class="s2">From </span><span class="si">{</span><span class="n">from_date</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">);</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of date_from/date_to dates has been provided. Please provide both dates or use the dt parameter only.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileDynamics.save">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileDynamics.save" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Save object using pickle.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the file to save.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>Path to the directory where to save the object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>file (pkl)</code></td>
      <td><p>pickle file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save object using pickle.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of the file to save.</span>
<span class="sd">        out_dir (str): Path to the directory where to save the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        file (pkl): pickle file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">savetxt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">.p&quot;</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="n">savetxt</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span> <span class="p">)</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ProfileDynamics object saved in </span><span class="si">{</span><span class="n">savetxt</span><span class="si">}</span><span class="s2"> .&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="sandpyper.sandpyper.ProfileSet">
        <code>ProfileSet</code>



<a class="headerlink" href="#sandpyper.sandpyper.ProfileSet" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileSet.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dirNameDSM</span><span class="p">,</span> <span class="n">dirNameOrtho</span><span class="p">,</span> <span class="n">dirNameTrans</span><span class="p">,</span> <span class="n">transects_spacing</span><span class="p">,</span> <span class="n">loc_codes</span><span class="p">,</span> <span class="n">loc_search_dict</span><span class="p">,</span> <span class="n">crs_dict_string</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a class="headerlink" href="#sandpyper.sandpyper.ProfileSet.__init__" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>This class sets up the monitoring global parameters, input files directories and creates a check dataframe to confirm all CRSs and files are matched up correctly.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dirNameDSM</code></td>
        <td><code>str</code></td>
        <td><p>Path of the directory containing the DSM datasets.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dirNameOrtho</code></td>
        <td><code>str</code></td>
        <td><p>Path of the directory containing the orthophotos datasets.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dirNameTrans</code></td>
        <td><code>str</code></td>
        <td><p>Path of the directory containing the transect files (.gpkg, .shp).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>transects_spacing</code></td>
        <td><code>float</code></td>
        <td><p>The alonghsore spacing between transects.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>loc_codes</code></td>
        <td><code>list</code></td>
        <td><p>List of strings of location codes.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>loc_search_dict</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary where keys are the location codes and values are lists containing the expected full location string, including the location code itself (["wbl","Warrnambool", "warrnambool","warrny"]).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>crs_dict_string</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary storing location codes as key and crs information as EPSG code (int).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>check</code></td>
        <td><code>str</code></td>
        <td><p>If 'all', the check dataframe will contain both DSMs and orthophotos information. If one of 'dsm' or 'ortho', only check the desired data type.</p></td>
        <td><code>&#39;all&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>ProfileSet object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">dirNameDSM</span><span class="p">,</span>
             <span class="n">dirNameOrtho</span><span class="p">,</span>
             <span class="n">dirNameTrans</span><span class="p">,</span>
             <span class="n">transects_spacing</span><span class="p">,</span>
             <span class="n">loc_codes</span><span class="p">,</span>
             <span class="n">loc_search_dict</span><span class="p">,</span>
             <span class="n">crs_dict_string</span><span class="p">,</span>
            <span class="n">check</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class sets up the monitoring global parameters, input files directories and creates a check dataframe to confirm all CRSs and files are matched up correctly.</span>

<span class="sd">    Args:</span>
<span class="sd">        dirNameDSM (str): Path of the directory containing the DSM datasets.</span>
<span class="sd">        dirNameOrtho (str): Path of the directory containing the orthophotos datasets.</span>
<span class="sd">        dirNameTrans (str): Path of the directory containing the transect files (.gpkg, .shp).</span>
<span class="sd">        transects_spacing (float): The alonghsore spacing between transects.</span>
<span class="sd">        loc_codes (list): List of strings of location codes.</span>
<span class="sd">        loc_search_dict (dict): A dictionary where keys are the location codes and values are lists containing the expected full location string, including the location code itself ([&quot;wbl&quot;,&quot;Warrnambool&quot;, &quot;warrnambool&quot;,&quot;warrny&quot;]).</span>
<span class="sd">        crs_dict_string (dict): Dictionary storing location codes as key and crs information as EPSG code (int).</span>
<span class="sd">        check (str, optional): If &#39;all&#39;, the check dataframe will contain both DSMs and orthophotos information. If one of &#39;dsm&#39; or &#39;ortho&#39;, only check the desired data type.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: ProfileSet object.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">dirNameDSM</span><span class="o">=</span><span class="n">dirNameDSM</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dirNameOrtho</span><span class="o">=</span><span class="n">dirNameOrtho</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dirNameTrans</span><span class="o">=</span><span class="n">dirNameTrans</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transects_spacing</span><span class="o">=</span><span class="n">transects_spacing</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">loc_codes</span><span class="o">=</span><span class="n">loc_codes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loc_search_dict</span><span class="o">=</span><span class="n">loc_search_dict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crs_dict_string</span><span class="o">=</span><span class="n">crs_dict_string</span>

    <span class="k">if</span> <span class="n">check</span><span class="o">==</span><span class="s2">&quot;dsm&quot;</span><span class="p">:</span>
        <span class="n">path_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameDSM</span>
    <span class="k">elif</span> <span class="n">check</span> <span class="o">==</span> <span class="s2">&quot;ortho&quot;</span><span class="p">:</span>
        <span class="n">path_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameOrtho</span>
    <span class="k">elif</span> <span class="n">check</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">path_in</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameDSM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirNameOrtho</span><span class="p">]</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="o">=</span><span class="n">cross_ref</span><span class="p">(</span><span class="n">path_in</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dirNameTrans</span><span class="p">,</span>
                    <span class="n">print_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">loc_search_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loc_search_dict</span><span class="p">,</span>
                    <span class="n">list_loc_codes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loc_codes</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileSet.cleanit">
<code class="highlight language-python"><span class="n">cleanit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l_dicts</span><span class="p">,</span> <span class="n">cluster_field</span><span class="o">=</span><span class="s1">&#39;label_k&#39;</span><span class="p">,</span> <span class="n">fill_class</span><span class="o">=</span><span class="s1">&#39;sand&#39;</span><span class="p">,</span> <span class="n">watermasks_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">water_label</span><span class="o">=</span><span class="s1">&#39;water&#39;</span><span class="p">,</span> <span class="n">shoremasks_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_corrections_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs_dict_string</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">geometry_field</span><span class="o">=</span><span class="s1">&#39;coordinates&#39;</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileSet.cleanit" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Transforms labels k into meaningful classes (sand, water, vegetation ,..) and apply fine-tuning correction, shoremasking and watermasking cleaning procedures.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>l_dicts</code></td>
        <td><code>list</code></td>
        <td><p>List of classes dictionaries containing the interpretations of each label k in every survey.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cluster_field</code></td>
        <td><code>str</code></td>
        <td><p>Name of the field storing the labels k to transform (default "label_k").</p></td>
        <td><code>&#39;label_k&#39;</code></td>
      </tr>
      <tr>
        <td><code>fill_class</code></td>
        <td><code>str</code></td>
        <td><p>Class assigned to points that have no label_k specified in l_dicts.</p></td>
        <td><code>&#39;sand&#39;</code></td>
      </tr>
      <tr>
        <td><code>watermasks_path</code></td>
        <td><code>str</code></td>
        <td><p>Path to the watermasking file.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>water_label</code></td>
        <td><code></code></td>
        <td><p>.</p></td>
        <td><code>&#39;water&#39;</code></td>
      </tr>
      <tr>
        <td><code>shoremasks_path</code></td>
        <td><code></code></td>
        <td><p>Path to the shoremasking file.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>label_corrections_path</code></td>
        <td><code></code></td>
        <td><p>Path to the label correction file.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs_dict_string</code></td>
        <td><code></code></td>
        <td><p>Dictionary storing location codes as key and crs information as EPSG code (int).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>geometry_field</code></td>
        <td><code></code></td>
        <td><p>Field that stores the point geometry (default 'geometry').</p></td>
        <td><code>&#39;coordinates&#39;</code></td>
      </tr>
  </tbody>
</table>      <p>Returns:
    label_k (int): new column in ProfileSet.profiles dataframe storing each point cluster label.</p>

        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cleanit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l_dicts</span><span class="p">,</span> <span class="n">cluster_field</span><span class="o">=</span><span class="s1">&#39;label_k&#39;</span><span class="p">,</span> <span class="n">fill_class</span><span class="o">=</span><span class="s1">&#39;sand&#39;</span><span class="p">,</span>
            <span class="n">watermasks_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">water_label</span><span class="o">=</span><span class="s1">&#39;water&#39;</span><span class="p">,</span>
            <span class="n">shoremasks_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_corrections_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">crs_dict_string</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">geometry_field</span><span class="o">=</span><span class="s1">&#39;coordinates&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transforms labels k into meaningful classes (sand, water, vegetation ,..) and apply fine-tuning correction, shoremasking and watermasking cleaning procedures.</span>

<span class="sd">    Args:</span>
<span class="sd">        l_dicts (list): List of classes dictionaries containing the interpretations of each label k in every survey.</span>
<span class="sd">        cluster_field (str): Name of the field storing the labels k to transform (default &quot;label_k&quot;).</span>
<span class="sd">        fill_class (str): Class assigned to points that have no label_k specified in l_dicts.</span>
<span class="sd">        watermasks_path (str): Path to the watermasking file.</span>
<span class="sd">        water_label: .</span>
<span class="sd">        shoremasks_path: Path to the shoremasking file.</span>
<span class="sd">        label_corrections_path: Path to the label correction file.</span>
<span class="sd">        crs_dict_string: Dictionary storing location codes as key and crs information as EPSG code (int).</span>
<span class="sd">        geometry_field: Field that stores the point geometry (default &#39;geometry&#39;).</span>

<span class="sd">     Returns:</span>
<span class="sd">        label_k (int): new column in ProfileSet.profiles dataframe storing each point cluster label.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">processes</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">if</span> <span class="n">label_corrections_path</span><span class="p">:</span> <span class="n">processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;polygon finetuning&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">watermasks_path</span><span class="p">:</span> <span class="n">processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;watermasking&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shoremasks_path</span><span class="p">:</span> <span class="n">processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;shoremasking&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">processes</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">cleaning_steps</span> <span class="o">=</span> <span class="n">processes</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">cleanit</span><span class="p">(</span><span class="n">to_clean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">,</span><span class="n">l_dicts</span><span class="o">=</span><span class="n">l_dicts</span><span class="p">,</span> <span class="n">cluster_field</span><span class="o">=</span><span class="n">cluster_field</span><span class="p">,</span> <span class="n">fill_class</span><span class="o">=</span><span class="n">fill_class</span><span class="p">,</span>
                <span class="n">watermasks_path</span><span class="o">=</span><span class="n">watermasks_path</span><span class="p">,</span> <span class="n">water_label</span><span class="o">=</span><span class="n">water_label</span><span class="p">,</span>
                <span class="n">shoremasks_path</span><span class="o">=</span><span class="n">shoremasks_path</span><span class="p">,</span> <span class="n">label_corrections_path</span><span class="o">=</span><span class="n">label_corrections_path</span><span class="p">,</span>
                <span class="n">crs_dict_string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs_dict_string</span><span class="p">,</span>
               <span class="n">geometry_field</span><span class="o">=</span><span class="n">geometry_field</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileSet.extract_profiles">
<code class="highlight language-python"><span class="n">extract_profiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">tr_ids</span><span class="p">,</span> <span class="n">sampling_step</span><span class="p">,</span> <span class="n">lod_mode</span><span class="p">,</span> <span class="n">add_xy</span><span class="p">,</span> <span class="n">add_slope</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_nan_values</span><span class="o">=-</span><span class="mi">10000</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileSet.extract_profiles" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Extract pixel values from orthophotos, DSMs or both, along transects in all surveys as a GeoDataFrame stored in the ProfileSet.profiles attribute.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mode</code></td>
        <td><code>str</code></td>
        <td><p>If 'dsm', extract from DSMs. If 'ortho', extracts from orthophotos. if "all", extract from both.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tr_ids</code></td>
        <td><code>str</code></td>
        <td><p>The name of the field in the transect file that is used to store the transects ID.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sampling_step</code></td>
        <td><code>float</code></td>
        <td><p>Distance along-transect to extract data points from. In meters.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lod_mode</code></td>
        <td><code></code></td>
        <td><p>If a valid path to a folder storing the LoD transects is provided, extracts elevation data (error) along those transects. If a value is provided, use this value across all surveys. If set to zero, then no LoD will be used.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>add_xy</code></td>
        <td><code>bool</code></td>
        <td><p>If True, adds extra columns with long and lat coordinates in the input CRS.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>add_slope</code></td>
        <td><code>bool</code></td>
        <td><p>If True, computes slope raster in degrees (increased processing time) and extract slope values across transects.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>default_nan_values</code></td>
        <td><code>int</code></td>
        <td><p>Value used for NoData specification in the rasters used. In Pix4D, this is -10000 (default).</p></td>
        <td><code>-10000</code></td>
      </tr>
  </tbody>
</table>      <p>Returns:
    attributes (pd.DataFrame): adds an attribute (.profiles) to the ProfileSet object and if lod_mode is active adds another attribute (.lod) with the elevation change along LoD transects.</p>

        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_profiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">mode</span><span class="p">,</span>
                     <span class="n">tr_ids</span><span class="p">,</span>
                     <span class="n">sampling_step</span><span class="p">,</span>
                     <span class="n">lod_mode</span><span class="p">,</span>
                     <span class="n">add_xy</span><span class="p">,</span>
                     <span class="n">add_slope</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">default_nan_values</span><span class="o">=-</span><span class="mi">10000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract pixel values from orthophotos, DSMs or both, along transects in all surveys as a GeoDataFrame stored in the ProfileSet.profiles attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">        mode (str): If &#39;dsm&#39;, extract from DSMs. If &#39;ortho&#39;, extracts from orthophotos. if &quot;all&quot;, extract from both.</span>
<span class="sd">        tr_ids (str): The name of the field in the transect file that is used to store the transects ID.</span>
<span class="sd">        sampling_step (float): Distance along-transect to extract data points from. In meters.</span>
<span class="sd">        lod_mode (): If a valid path to a folder storing the LoD transects is provided, extracts elevation data (error) along those transects. If a value is provided, use this value across all surveys. If set to zero, then no LoD will be used.</span>
<span class="sd">        add_xy (bool): If True, adds extra columns with long and lat coordinates in the input CRS.</span>
<span class="sd">        add_slope (bool): If True, computes slope raster in degrees (increased processing time) and extract slope values across transects.</span>
<span class="sd">        default_nan_values (int): Value used for NoData specification in the rasters used. In Pix4D, this is -10000 (default).</span>

<span class="sd">     Returns:</span>
<span class="sd">        attributes (pd.DataFrame): adds an attribute (.profiles) to the ProfileSet object and if lod_mode is active adds another attribute (.lod) with the elevation change along LoD transects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mode</span><span class="o">==</span><span class="s2">&quot;dsm&quot;</span><span class="p">:</span>
        <span class="n">path_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameDSM</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;ortho&quot;</span><span class="p">:</span>
        <span class="n">path_in</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameOrtho</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">path_in</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameDSM</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameOrtho</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;mode must be either &#39;dsm&#39;,&#39;ortho&#39; or &#39;all&#39;.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dsm&quot;</span><span class="p">,</span><span class="s2">&quot;ortho&quot;</span><span class="p">]:</span>

        <span class="n">profiles</span><span class="o">=</span><span class="n">extract_from_folder</span><span class="p">(</span><span class="n">dataset_folder</span><span class="o">=</span><span class="n">path_in</span><span class="p">,</span>
            <span class="n">transect_folder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameTrans</span><span class="p">,</span>
            <span class="n">tr_ids</span><span class="o">=</span><span class="n">tr_ids</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">sampling_step</span><span class="o">=</span><span class="n">sampling_step</span><span class="p">,</span>
            <span class="n">list_loc_codes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loc_codes</span><span class="p">,</span>
            <span class="n">add_xy</span><span class="o">=</span><span class="n">add_xy</span><span class="p">,</span>
            <span class="n">add_slope</span><span class="o">=</span><span class="n">add_slope</span><span class="p">,</span>
            <span class="n">default_nan_values</span><span class="o">=</span><span class="n">default_nan_values</span><span class="p">)</span>

        <span class="n">profiles</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">profiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracting elevation from DSMs . . .&quot;</span><span class="p">)</span>
        <span class="n">profiles_z</span><span class="o">=</span><span class="n">extract_from_folder</span><span class="p">(</span> <span class="n">dataset_folder</span><span class="o">=</span><span class="n">path_in</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">transect_folder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameTrans</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;dsm&quot;</span><span class="p">,</span>
                <span class="n">tr_ids</span><span class="o">=</span><span class="n">tr_ids</span><span class="p">,</span>
                <span class="n">sampling_step</span><span class="o">=</span><span class="n">sampling_step</span><span class="p">,</span>
                <span class="n">list_loc_codes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loc_codes</span><span class="p">,</span>
                <span class="n">add_xy</span><span class="o">=</span><span class="n">add_xy</span><span class="p">,</span>
                <span class="n">add_slope</span><span class="o">=</span><span class="n">add_slope</span><span class="p">,</span>
                <span class="n">default_nan_values</span><span class="o">=</span><span class="n">default_nan_values</span> <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracting rgb values from orthos . . .&quot;</span><span class="p">)</span>
        <span class="n">profiles_rgb</span><span class="o">=</span><span class="n">extract_from_folder</span><span class="p">(</span><span class="n">dataset_folder</span><span class="o">=</span><span class="n">path_in</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">transect_folder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameTrans</span><span class="p">,</span>
            <span class="n">tr_ids</span><span class="o">=</span><span class="n">tr_ids</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ortho&quot;</span><span class="p">,</span><span class="n">sampling_step</span><span class="o">=</span><span class="n">sampling_step</span><span class="p">,</span>
            <span class="n">list_loc_codes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loc_codes</span><span class="p">,</span>
            <span class="n">add_xy</span><span class="o">=</span><span class="n">add_xy</span><span class="p">,</span>
            <span class="n">default_nan_values</span><span class="o">=</span><span class="n">default_nan_values</span><span class="p">)</span>

        <span class="n">profiles_rgb</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">profiles_rgb</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">profiles_z</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">profiles_z</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">profiles_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">profiles_z</span><span class="p">,</span><span class="n">profiles_rgb</span><span class="p">[[</span><span class="s2">&quot;band1&quot;</span><span class="p">,</span><span class="s2">&quot;band2&quot;</span><span class="p">,</span><span class="s2">&quot;band3&quot;</span><span class="p">,</span><span class="s2">&quot;point_id&quot;</span><span class="p">]],</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;point_id&quot;</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="s2">&quot;one_to_one&quot;</span><span class="p">)</span>
        <span class="n">profiles_merged</span><span class="o">=</span><span class="n">profiles_merged</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
        <span class="n">profiles_merged</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">profiles_merged</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">=</span><span class="n">profiles_merged</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;mode must be either &#39;dsm&#39;,&#39;ortho&#39; or &#39;all&#39;.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sampling_step</span><span class="o">=</span><span class="n">sampling_step</span>


    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">lod_mode</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;dsm&#39;</span><span class="p">:</span>
            <span class="n">lod_path_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dirNameDSM</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">lod_path_data</span><span class="o">=</span><span class="n">path_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracting LoD values&quot;</span><span class="p">)</span>

        <span class="n">lod</span><span class="o">=</span><span class="n">extract_from_folder</span><span class="p">(</span> <span class="n">dataset_folder</span><span class="o">=</span><span class="n">lod_path_data</span><span class="p">,</span>
                <span class="n">transect_folder</span><span class="o">=</span><span class="n">lod_mode</span><span class="p">,</span>
                <span class="n">tr_ids</span><span class="o">=</span><span class="n">tr_ids</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;dsm&quot;</span><span class="p">,</span>
                <span class="n">sampling_step</span><span class="o">=</span><span class="n">sampling_step</span><span class="p">,</span>
                <span class="n">list_loc_codes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loc_codes</span><span class="p">,</span>
                <span class="n">add_xy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">add_slope</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">default_nan_values</span><span class="o">=</span><span class="n">default_nan_values</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod</span><span class="o">=</span><span class="n">lod</span>


    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lod_mode</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="n">lod_mode</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lod</span><span class="o">=</span><span class="n">lod</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;lod_mode must be a path directing to the folder of lod profiles, a numerical value or None.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileSet.kmeans_sa">
<code class="highlight language-python"><span class="n">kmeans_sa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ks</span><span class="p">,</span> <span class="n">feature_set</span><span class="p">,</span> <span class="n">thresh_k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileSet.kmeans_sa" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Cluster data using a specified feature set with KMeans algorithm and a dictionary of optimal number of clusters to use for each survey (see get_sil_location and get_opt_k functions).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ks</code></td>
        <td><code>dictionary</code></td>
        <td><p>Number of clusters (k) or dictionary containing a k for each survey.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>feature_set</code></td>
        <td><code>list</code></td>
        <td><p>List of names of features (columns of the ProfileSet.profiles dataframe) to use for clustering.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>thresh_k</code></td>
        <td><code>int</code></td>
        <td><p>Minimim k to be used. If survey-specific optimal k is below this value, then k equals the average k of all above threshold values.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>random_state</code></td>
        <td><code>int</code></td>
        <td><p>Random seed used to make the randomisation deterministic.</p></td>
        <td><code>10</code></td>
      </tr>
  </tbody>
</table>      <p>Returns:
    column (int): new column in ProfileSet.profiles dataframe storing each point cluster label.</p>

        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">kmeans_sa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ks</span><span class="p">,</span> <span class="n">feature_set</span><span class="p">,</span> <span class="n">thresh_k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cluster data using a specified feature set with KMeans algorithm and a dictionary of optimal number of clusters to use for each survey (see get_sil_location and get_opt_k functions).</span>

<span class="sd">    Args:</span>
<span class="sd">        ks (dictionary): Number of clusters (k) or dictionary containing a k for each survey.</span>
<span class="sd">        feature_set (list): List of names of features (columns of the ProfileSet.profiles dataframe) to use for clustering.</span>
<span class="sd">        thresh_k (int, optional): Minimim k to be used. If survey-specific optimal k is below this value, then k equals the average k of all above threshold values.</span>
<span class="sd">        random_state (int, optional): Random seed used to make the randomisation deterministic.</span>

<span class="sd">     Returns:</span>
<span class="sd">        column (int): new column in ProfileSet.profiles dataframe storing each point cluster label.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">labels_df</span><span class="o">=</span><span class="n">kmeans_sa</span><span class="p">(</span><span class="n">merged_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">,</span>
        <span class="n">ks</span><span class="o">=</span><span class="n">ks</span><span class="p">,</span>
        <span class="n">feature_set</span><span class="o">=</span><span class="n">feature_set</span><span class="p">,</span>
        <span class="n">thresh_k</span><span class="o">=</span><span class="n">thresh_k</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">labels_df</span><span class="p">[[</span><span class="s2">&quot;point_id&quot;</span><span class="p">,</span><span class="s2">&quot;label_k&quot;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;point_id&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;one_to_one&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="sandpyper.sandpyper.ProfileSet.save">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">)</span></code>


<a class="headerlink" href="#sandpyper.sandpyper.ProfileSet.save" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Save object using pickle.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the file to save.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>Path to the directory where to save the object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>file (pkl)</code></td>
      <td><p>pickle file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>sandpyper\sandpyper.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save object using pickle.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of the file to save.</span>
<span class="sd">        out_dir (str): Path to the directory where to save the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        file (pkl): pickle file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">savetxt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">.p&quot;</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="n">savetxt</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span> <span class="p">)</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ProfileSet object saved in </span><span class="si">{</span><span class="n">savetxt</span><span class="si">}</span><span class="s2"> .&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: 2021-10-13
    
  </small>
</div>
                  
                
              

              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../volumetrics_method/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Volumetrics" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Volumetrics
            </div>
          </div>
        </a>
      
      
        
        <a href="../common/" class="md-footer__link md-footer__link--next" aria-label="Next: common module" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              common module
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "search.highlight", "navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.29db7785.min.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>